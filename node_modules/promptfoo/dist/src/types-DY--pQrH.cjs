const require_logger = require('./logger-CMp-NS-e.cjs');
const require_fileExtensions = require('./fileExtensions-DkJYkWUy.cjs');
let dedent = require("dedent");
dedent = require_logger.__toESM(dedent);
let zod = require("zod");

//#region src/types/env.ts
const ProviderEnvOverridesSchema = zod.z.object({
	AI21_API_BASE_URL: zod.z.string().optional(),
	AI21_API_KEY: zod.z.string().optional(),
	AIML_API_KEY: zod.z.string().optional(),
	ANTHROPIC_API_KEY: zod.z.string().optional(),
	ANTHROPIC_BASE_URL: zod.z.string().optional(),
	AWS_BEDROCK_REGION: zod.z.string().optional(),
	AZURE_API_BASE_URL: zod.z.string().optional(),
	AZURE_API_HOST: zod.z.string().optional(),
	AZURE_API_KEY: zod.z.string().optional(),
	AZURE_AUTHORITY_HOST: zod.z.string().optional(),
	AZURE_CLIENT_ID: zod.z.string().optional(),
	AZURE_CLIENT_SECRET: zod.z.string().optional(),
	AZURE_DEPLOYMENT_NAME: zod.z.string().optional(),
	AZURE_EMBEDDING_DEPLOYMENT_NAME: zod.z.string().optional(),
	AZURE_OPENAI_API_BASE_URL: zod.z.string().optional(),
	AZURE_OPENAI_API_HOST: zod.z.string().optional(),
	AZURE_OPENAI_API_KEY: zod.z.string().optional(),
	AZURE_OPENAI_BASE_URL: zod.z.string().optional(),
	AZURE_OPENAI_DEPLOYMENT_NAME: zod.z.string().optional(),
	AZURE_OPENAI_EMBEDDING_DEPLOYMENT_NAME: zod.z.string().optional(),
	AZURE_TENANT_ID: zod.z.string().optional(),
	AZURE_TOKEN_SCOPE: zod.z.string().optional(),
	CLAUDE_CODE_USE_BEDROCK: zod.z.string().optional(),
	CLAUDE_CODE_USE_VERTEX: zod.z.string().optional(),
	CLOUDFLARE_ACCOUNT_ID: zod.z.string().optional(),
	CLOUDFLARE_API_KEY: zod.z.string().optional(),
	CLOUDFLARE_GATEWAY_ID: zod.z.string().optional(),
	CF_AIG_TOKEN: zod.z.string().optional(),
	COMETAPI_KEY: zod.z.string().optional(),
	COHERE_API_KEY: zod.z.string().optional(),
	COHERE_CLIENT_NAME: zod.z.string().optional(),
	DATABRICKS_TOKEN: zod.z.string().optional(),
	DATABRICKS_WORKSPACE_URL: zod.z.string().optional(),
	DOCKER_MODEL_RUNNER_BASE_URL: zod.z.string().optional(),
	DOCKER_MODEL_RUNNER_API_KEY: zod.z.string().optional(),
	ELEVENLABS_API_KEY: zod.z.string().optional(),
	FAL_KEY: zod.z.string().optional(),
	GITHUB_TOKEN: zod.z.string().optional(),
	GOOGLE_API_HOST: zod.z.string().optional(),
	GOOGLE_API_BASE_URL: zod.z.string().optional(),
	GOOGLE_API_KEY: zod.z.string().optional(),
	GOOGLE_PROJECT_ID: zod.z.string().optional(),
	GOOGLE_LOCATION: zod.z.string().optional(),
	GOOGLE_GENERATIVE_AI_API_KEY: zod.z.string().optional(),
	GEMINI_API_KEY: zod.z.string().optional(),
	GROQ_API_KEY: zod.z.string().optional(),
	HELICONE_API_KEY: zod.z.string().optional(),
	HF_API_TOKEN: zod.z.string().optional(),
	HF_TOKEN: zod.z.string().optional(),
	HYPERBOLIC_API_KEY: zod.z.string().optional(),
	HUGGING_FACE_HUB_TOKEN: zod.z.string().optional(),
	JFROG_API_KEY: zod.z.string().optional(),
	LANGFUSE_HOST: zod.z.string().optional(),
	LANGFUSE_PUBLIC_KEY: zod.z.string().optional(),
	LANGFUSE_SECRET_KEY: zod.z.string().optional(),
	LITELLM_API_BASE: zod.z.string().optional(),
	LLAMA_BASE_URL: zod.z.string().optional(),
	LOCALAI_BASE_URL: zod.z.string().optional(),
	MISTRAL_API_BASE_URL: zod.z.string().optional(),
	MISTRAL_API_HOST: zod.z.string().optional(),
	MISTRAL_API_KEY: zod.z.string().optional(),
	NSCALE_SERVICE_TOKEN: zod.z.string().optional(),
	NSCALE_API_KEY: zod.z.string().optional(),
	OLLAMA_API_KEY: zod.z.string().optional(),
	OLLAMA_BASE_URL: zod.z.string().optional(),
	OPENAI_API_BASE_URL: zod.z.string().optional(),
	OPENAI_API_HOST: zod.z.string().optional(),
	OPENAI_API_KEY: zod.z.string().optional(),
	OPENAI_BASE_URL: zod.z.string().optional(),
	OPENAI_ORGANIZATION: zod.z.string().optional(),
	CODEX_API_KEY: zod.z.string().optional(),
	PALM_API_HOST: zod.z.string().optional(),
	PALM_API_KEY: zod.z.string().optional(),
	PORTKEY_API_KEY: zod.z.string().optional(),
	PROMPTFOO_CA_CERT_PATH: zod.z.string().optional(),
	PROMPTFOO_PFX_CERT_PATH: zod.z.string().optional(),
	PROMPTFOO_PFX_PASSWORD: zod.z.string().optional(),
	PROMPTFOO_JKS_CERT_PATH: zod.z.string().optional(),
	PROMPTFOO_JKS_PASSWORD: zod.z.string().optional(),
	PROMPTFOO_JKS_ALIAS: zod.z.string().optional(),
	PROMPTFOO_INSECURE_SSL: zod.z.string().optional(),
	QUIVERAI_API_KEY: zod.z.string().optional(),
	REPLICATE_API_KEY: zod.z.string().optional(),
	REPLICATE_API_TOKEN: zod.z.string().optional(),
	SHAREPOINT_BASE_URL: zod.z.string().optional(),
	SHAREPOINT_CERT_PATH: zod.z.string().optional(),
	SHAREPOINT_CLIENT_ID: zod.z.string().optional(),
	SHAREPOINT_TENANT_ID: zod.z.string().optional(),
	VERCEL_AI_GATEWAY_API_KEY: zod.z.string().optional(),
	VERCEL_AI_GATEWAY_BASE_URL: zod.z.string().optional(),
	VERTEX_API_HOST: zod.z.string().optional(),
	VERTEX_API_KEY: zod.z.string().optional(),
	VERTEX_API_VERSION: zod.z.string().optional(),
	VERTEX_PROJECT_ID: zod.z.string().optional(),
	VERTEX_PUBLISHER: zod.z.string().optional(),
	VERTEX_REGION: zod.z.string().optional(),
	VOYAGE_API_BASE_URL: zod.z.string().optional(),
	VOYAGE_API_KEY: zod.z.string().optional(),
	WATSONX_AI_APIKEY: zod.z.string().optional(),
	WATSONX_AI_AUTH_TYPE: zod.z.string().optional(),
	WATSONX_AI_BEARER_TOKEN: zod.z.string().optional(),
	WATSONX_AI_PROJECT_ID: zod.z.string().optional(),
	XAI_API_BASE_URL: zod.z.string().optional(),
	XAI_API_KEY: zod.z.string().optional(),
	AZURE_CONTENT_SAFETY_ENDPOINT: zod.z.string().optional(),
	AZURE_CONTENT_SAFETY_API_KEY: zod.z.string().optional(),
	AZURE_CONTENT_SAFETY_API_VERSION: zod.z.string().optional(),
	AWS_REGION: zod.z.string().optional(),
	AWS_DEFAULT_REGION: zod.z.string().optional(),
	AWS_SAGEMAKER_MAX_TOKENS: zod.z.string().optional(),
	AWS_SAGEMAKER_TEMPERATURE: zod.z.string().optional(),
	AWS_SAGEMAKER_TOP_P: zod.z.string().optional(),
	AWS_SAGEMAKER_MAX_RETRIES: zod.z.string().optional(),
	PROMPTFOO_EVAL_TIMEOUT_MS: zod.z.string().optional()
});

//#endregion
//#region src/types/shared.ts
const CompletionTokenDetailsSchema = zod.z.object({
	reasoning: zod.z.number().optional(),
	acceptedPrediction: zod.z.number().optional(),
	rejectedPrediction: zod.z.number().optional()
});
/**
* Base schema for token usage statistics with all fields optional
*/
const BaseTokenUsageSchema = zod.z.object({
	prompt: zod.z.number().optional(),
	completion: zod.z.number().optional(),
	cached: zod.z.number().optional(),
	total: zod.z.number().optional(),
	numRequests: zod.z.number().optional(),
	completionDetails: CompletionTokenDetailsSchema.optional(),
	assertions: zod.z.object({
		total: zod.z.number().optional(),
		prompt: zod.z.number().optional(),
		completion: zod.z.number().optional(),
		cached: zod.z.number().optional(),
		numRequests: zod.z.number().optional(),
		completionDetails: CompletionTokenDetailsSchema.optional()
	}).optional()
});
const InputsSchema = zod.z.record(zod.z.string().regex(/^[a-zA-Z_][a-zA-Z0-9_]*$/, { error: "Input variable names must be valid identifiers (start with letter or underscore)" }), zod.z.string().min(1, { error: "Input descriptions must be non-empty strings" }));

//#endregion
//#region src/validators/prompts.ts
const PromptConfigSchema = zod.z.object({
	prefix: zod.z.string().optional(),
	suffix: zod.z.string().optional()
});
const PromptFunctionSchema = zod.z.custom((v) => typeof v === "function");
const PromptSchema = zod.z.object({
	id: zod.z.string().optional(),
	raw: zod.z.string(),
	display: zod.z.string().optional(),
	label: zod.z.string(),
	function: PromptFunctionSchema.optional(),
	config: zod.z.any().optional()
});
function assert$1() {}
assert$1();
assert$1();
assert$1();

//#endregion
//#region src/redteam/constants/plugins.ts
const DEFAULT_NUM_TESTS_PER_PLUGIN = 5;
const MULTI_INPUT_VAR = "__prompt";
const LLAMA_GUARD_REPLICATE_PROVIDER = "replicate:moderation:meta/llama-guard-4-12b";
const LLAMA_GUARD_ENABLED_CATEGORIES = [
	"S1",
	"S2",
	"S3",
	"S4",
	"S5",
	"S6",
	"S8",
	"S9",
	"S10",
	"S11",
	"S12",
	"S13"
];
const FOUNDATION_PLUGINS = [
	"ascii-smuggling",
	"beavertails",
	"bias:age",
	"bias:disability",
	"bias:gender",
	"bias:race",
	"contracts",
	"cyberseceval",
	"donotanswer",
	"divergent-repetition",
	"excessive-agency",
	"hallucination",
	"harmful:chemical-biological-weapons",
	"harmful:child-exploitation",
	"harmful:copyright-violations",
	"harmful:cybercrime",
	"harmful:cybercrime:malicious-code",
	"harmful:graphic-content",
	"harmful:harassment-bullying",
	"harmful:hate",
	"harmful:illegal-activities",
	"harmful:illegal-drugs",
	"harmful:illegal-drugs:meth",
	"harmful:indiscriminate-weapons",
	"harmful:insults",
	"harmful:intellectual-property",
	"harmful:misinformation-disinformation",
	"harmful:non-violent-crime",
	"harmful:profanity",
	"harmful:radicalization",
	"harmful:self-harm",
	"harmful:sex-crime",
	"harmful:sexual-content",
	"harmful:specialized-advice",
	"harmful:unsafe-practices",
	"harmful:violent-crime",
	"harmful:weapons:ied",
	"hijacking",
	"imitation",
	"overreliance",
	"pii:direct",
	"pliny",
	"politics",
	"religion"
];
const GUARDRAILS_EVALUATION_PLUGINS = [
	"ascii-smuggling",
	"indirect-prompt-injection",
	"cca",
	"hijacking",
	"system-prompt-override",
	"beavertails",
	"harmbench",
	"pliny",
	"donotanswer",
	"prompt-extraction",
	"harmful:chemical-biological-weapons",
	"harmful:indiscriminate-weapons",
	"harmful:weapons:ied",
	"harmful:violent-crime",
	"harmful:sex-crime",
	"harmful:non-violent-crime",
	"harmful:graphic-content",
	"harmful:unsafe-practices",
	"harmful:child-exploitation",
	"harmful:harassment-bullying",
	"harmful:hate",
	"harmful:self-harm",
	"harmful:sexual-content",
	"harmful:insults",
	"harmful:profanity",
	"harmful:radicalization",
	"harmful:cybercrime",
	"harmful:cybercrime:malicious-code",
	"harmful:illegal-activities",
	"harmful:illegal-drugs",
	"harmful:illegal-drugs:meth",
	"harmful:misinformation-disinformation",
	"harmful:specialized-advice",
	"harmful:copyright-violations",
	"harmful:intellectual-property",
	"cyberseceval",
	"excessive-agency",
	"hallucination",
	"overreliance",
	"divergent-repetition",
	"reasoning-dos",
	"harmful:privacy"
];
const AGENTIC_PLUGINS = ["agentic:memory-poisoning"];
const COLLECTIONS = [
	"default",
	"foundation",
	"harmful",
	"pii",
	"bias",
	"medical",
	"pharmacy",
	"insurance",
	"financial",
	"ecommerce",
	"telecom",
	"guardrails-eval"
];
const UNALIGNED_PROVIDER_HARM_PLUGINS = {
	"harmful:child-exploitation": "Child Exploitation",
	"harmful:hate": "Hate",
	"harmful:indiscriminate-weapons": "Indiscriminate Weapons",
	"harmful:non-violent-crime": "Non-Violent Crimes",
	"harmful:self-harm": "Self-Harm",
	"harmful:sex-crime": "Sex Crimes",
	"harmful:sexual-content": "Sexual Content",
	"harmful:violent-crime": "Violent Crimes",
	"harmful:chemical-biological-weapons": "Chemical & Biological Weapons",
	"harmful:copyright-violations": "Copyright Violations - Copyrighted text",
	"harmful:cybercrime": "Cybercrime & Unauthorized Intrusion - Hacking and Malware",
	"harmful:graphic-content": "Graphic & age-restricted content",
	"harmful:harassment-bullying": "Harassment & Bullying",
	"harmful:illegal-activities": "Illegal Activities - Fraud & scams",
	"harmful:illegal-drugs": "Illegal Drugs",
	"harmful:unsafe-practices": "Promotion of unsafe practices",
	"harmful:insults": "Insults and personal attacks",
	"harmful:profanity": "Requests containing profanity",
	"harmful:radicalization": "Radicalization",
	"harmful:illegal-drugs:meth": "Methamphetamine",
	"harmful:weapons:ied": "Improvised Explosive Devices",
	"harmful:cybercrime:malicious-code": "Malicious Code"
};
const REDTEAM_PROVIDER_HARM_PLUGINS = {
	"harmful:intellectual-property": "Intellectual Property violation",
	"harmful:privacy": "Privacy violations"
};
const HARM_PLUGINS = {
	"harmful:misinformation-disinformation": "Misinformation & Disinformation - Harmful lies and propaganda",
	"harmful:specialized-advice": "Specialized Advice - Financial",
	...UNALIGNED_PROVIDER_HARM_PLUGINS,
	...REDTEAM_PROVIDER_HARM_PLUGINS
};
const PII_PLUGINS = [
	"pii:api-db",
	"pii:direct",
	"pii:session",
	"pii:social"
];
const BIAS_PLUGINS = [
	"bias:age",
	"bias:disability",
	"bias:gender",
	"bias:race"
];
const MEDICAL_PLUGINS = [
	"medical:anchoring-bias",
	"medical:hallucination",
	"medical:incorrect-knowledge",
	"medical:off-label-use",
	"medical:prioritization-error",
	"medical:sycophancy"
];
const FINANCIAL_PLUGINS = [
	"financial:calculation-error",
	"financial:compliance-violation",
	"financial:confidential-disclosure",
	"financial:counterfactual",
	"financial:data-leakage",
	"financial:defamation",
	"financial:hallucination",
	"financial:impartiality",
	"financial:misconduct",
	"financial:sycophancy"
];
const PHARMACY_PLUGINS = [
	"pharmacy:controlled-substance-compliance",
	"pharmacy:dosage-calculation",
	"pharmacy:drug-interaction"
];
const INSURANCE_PLUGINS = [
	"insurance:coverage-discrimination",
	"insurance:network-misinformation",
	"insurance:phi-disclosure"
];
const ECOMMERCE_PLUGINS = [
	"ecommerce:compliance-bypass",
	"ecommerce:order-fraud",
	"ecommerce:pci-dss",
	"ecommerce:price-manipulation"
];
const TELECOM_PLUGINS = [
	"telecom:cpni-disclosure",
	"telecom:location-disclosure",
	"telecom:account-takeover",
	"telecom:e911-misinformation",
	"telecom:tcpa-violation",
	"telecom:unauthorized-changes",
	"telecom:fraud-enablement",
	"telecom:porting-misinformation",
	"telecom:billing-misinformation",
	"telecom:coverage-misinformation",
	"telecom:law-enforcement-request-handling",
	"telecom:accessibility-violation"
];
const BASE_PLUGINS = [
	"contracts",
	"excessive-agency",
	"hallucination",
	"hijacking",
	"politics"
];
const ADDITIONAL_PLUGINS = [
	"aegis",
	"ascii-smuggling",
	"beavertails",
	"bfla",
	"bola",
	"cca",
	"competitors",
	"coppa",
	"cross-session-leak",
	"cyberseceval",
	"debug-access",
	"divergent-repetition",
	"donotanswer",
	"ferpa",
	"harmbench",
	"toxic-chat",
	"imitation",
	"indirect-prompt-injection",
	"mcp",
	"medical:anchoring-bias",
	"medical:hallucination",
	"medical:incorrect-knowledge",
	"medical:off-label-use",
	"medical:prioritization-error",
	"medical:sycophancy",
	"financial:calculation-error",
	"financial:compliance-violation",
	"financial:confidential-disclosure",
	"financial:counterfactual",
	"financial:data-leakage",
	"financial:defamation",
	"financial:hallucination",
	"financial:impartiality",
	"financial:misconduct",
	"financial:sycophancy",
	"ecommerce:compliance-bypass",
	"ecommerce:order-fraud",
	"ecommerce:pci-dss",
	"ecommerce:price-manipulation",
	"goal-misalignment",
	"insurance:coverage-discrimination",
	"insurance:network-misinformation",
	"insurance:phi-disclosure",
	"off-topic",
	"overreliance",
	"pharmacy:controlled-substance-compliance",
	"pharmacy:dosage-calculation",
	"pharmacy:drug-interaction",
	"telecom:cpni-disclosure",
	"telecom:location-disclosure",
	"telecom:account-takeover",
	"telecom:e911-misinformation",
	"telecom:tcpa-violation",
	"telecom:unauthorized-changes",
	"telecom:fraud-enablement",
	"telecom:porting-misinformation",
	"telecom:billing-misinformation",
	"telecom:coverage-misinformation",
	"telecom:law-enforcement-request-handling",
	"telecom:accessibility-violation",
	"pliny",
	"prompt-extraction",
	"rag-document-exfiltration",
	"rag-poisoning",
	"rag-source-attribution",
	"rbac",
	"reasoning-dos",
	"religion",
	"shell-injection",
	"special-token-injection",
	"sql-injection",
	"ssrf",
	"system-prompt-override",
	"tool-discovery",
	"unsafebench",
	"unverifiable-claims",
	"vlguard",
	"vlsu",
	"wordplay",
	"xstest"
];
const CONFIG_REQUIRED_PLUGINS = ["intent", "policy"];
const AGENTIC_EXEMPT_PLUGINS = ["system-prompt-override", "agentic:memory-poisoning"];
const DATASET_EXEMPT_PLUGINS = [
	"aegis",
	"beavertails",
	"cyberseceval",
	"donotanswer",
	"harmbench",
	"pliny",
	"toxic-chat",
	"unsafebench",
	"vlguard",
	"vlsu",
	"xstest"
];
const MULTI_INPUT_EXCLUDED_PLUGINS = [
	"cca",
	"cross-session-leak",
	"special-token-injection",
	"system-prompt-override",
	"ascii-smuggling"
];
const STRATEGY_EXEMPT_PLUGINS = [...AGENTIC_EXEMPT_PLUGINS, ...DATASET_EXEMPT_PLUGINS];
const DEFAULT_PLUGINS = new Set([...[
	...BASE_PLUGINS,
	...Object.keys(HARM_PLUGINS),
	...PII_PLUGINS,
	...BIAS_PLUGINS
].sort()]);
const RAG_PLUGINS = new Set([
	...DEFAULT_PLUGINS,
	"bola",
	"bfla",
	"rbac",
	"rag-source-attribution"
]);
const ALL_PLUGINS = [...new Set([
	...DEFAULT_PLUGINS,
	...ADDITIONAL_PLUGINS,
	...CONFIG_REQUIRED_PLUGINS,
	...AGENTIC_PLUGINS
])].sort();
const PLUGIN_CATEGORIES = {
	bias: BIAS_PLUGINS,
	ecommerce: ECOMMERCE_PLUGINS,
	financial: FINANCIAL_PLUGINS,
	harmful: Object.keys(HARM_PLUGINS),
	pii: PII_PLUGINS,
	medical: MEDICAL_PLUGINS,
	pharmacy: PHARMACY_PLUGINS,
	insurance: INSURANCE_PLUGINS,
	telecom: TELECOM_PLUGINS
};
const REMOTE_ONLY_PLUGIN_IDS = [
	"agentic:memory-poisoning",
	"ascii-smuggling",
	"bfla",
	"bola",
	"cca",
	"competitors",
	"coppa",
	"ferpa",
	"goal-misalignment",
	"harmful:misinformation-disinformation",
	"harmful:specialized-advice",
	"hijacking",
	"indirect-prompt-injection",
	"mcp",
	"off-topic",
	"rag-document-exfiltration",
	"rag-poisoning",
	"rag-source-attribution",
	"reasoning-dos",
	"religion",
	"special-token-injection",
	"ssrf",
	"system-prompt-override",
	"wordplay",
	...MEDICAL_PLUGINS,
	...FINANCIAL_PLUGINS,
	...PHARMACY_PLUGINS,
	...INSURANCE_PLUGINS,
	...ECOMMERCE_PLUGINS,
	...TELECOM_PLUGINS
];
const UI_DISABLED_WHEN_REMOTE_UNAVAILABLE = [
	...Object.keys(UNALIGNED_PROVIDER_HARM_PLUGINS),
	...BIAS_PLUGINS,
	...REMOTE_ONLY_PLUGIN_IDS
];

//#endregion
//#region src/redteam/constants/frameworks.ts
const OWASP_LLM_TOP_10_MAPPING = {
	"owasp:llm:01": {
		plugins: [
			"ascii-smuggling",
			"indirect-prompt-injection",
			"prompt-extraction",
			"harmful"
		],
		strategies: [
			"jailbreak",
			"jailbreak-templates",
			"jailbreak:composite"
		]
	},
	"owasp:llm:02": {
		plugins: [
			"pii:api-db",
			"pii:direct",
			"pii:session",
			"pii:social",
			"harmful:privacy",
			"cross-session-leak",
			"prompt-extraction"
		],
		strategies: [
			"jailbreak",
			"jailbreak-templates",
			"jailbreak:composite"
		]
	},
	"owasp:llm:03": {
		plugins: [],
		strategies: []
	},
	"owasp:llm:04": {
		plugins: [
			"harmful:misinformation-disinformation",
			"harmful:hate",
			"bias:age",
			"bias:disability",
			"bias:gender",
			"bias:race",
			"harmful:radicalization",
			"harmful:specialized-advice"
		],
		strategies: [
			"jailbreak",
			"jailbreak-templates",
			"jailbreak:composite"
		]
	},
	"owasp:llm:05": {
		plugins: [
			"shell-injection",
			"sql-injection",
			"ssrf",
			"debug-access"
		],
		strategies: ["jailbreak", "jailbreak-templates"]
	},
	"owasp:llm:06": {
		plugins: [
			"excessive-agency",
			"rbac",
			"bfla",
			"bola",
			"shell-injection",
			"sql-injection",
			"ssrf"
		],
		strategies: [
			"jailbreak",
			"jailbreak-templates",
			"jailbreak:composite"
		]
	},
	"owasp:llm:07": {
		plugins: [
			"prompt-extraction",
			"rbac",
			"harmful:privacy",
			"pii:api-db",
			"pii:direct",
			"pii:session",
			"pii:social"
		],
		strategies: [
			"jailbreak",
			"jailbreak-templates",
			"jailbreak:composite"
		]
	},
	"owasp:llm:08": {
		plugins: [
			"cross-session-leak",
			"harmful:privacy",
			"pii:api-db",
			"pii:direct",
			"pii:session",
			"pii:social"
		],
		strategies: [
			"jailbreak",
			"jailbreak-templates",
			"jailbreak:composite"
		]
	},
	"owasp:llm:09": {
		plugins: [
			"hallucination",
			"overreliance",
			"harmful:misinformation-disinformation",
			"harmful:specialized-advice"
		],
		strategies: [
			"jailbreak",
			"jailbreak-templates",
			"jailbreak:composite"
		]
	},
	"owasp:llm:10": {
		plugins: ["divergent-repetition", "reasoning-dos"],
		strategies: []
	}
};
const OWASP_API_TOP_10_MAPPING = {
	"owasp:api:01": {
		plugins: ["bola", "rbac"],
		strategies: []
	},
	"owasp:api:02": {
		plugins: ["bfla", "rbac"],
		strategies: []
	},
	"owasp:api:03": {
		plugins: ["excessive-agency", "overreliance"],
		strategies: []
	},
	"owasp:api:04": {
		plugins: [
			"harmful:privacy",
			"pii:api-db",
			"pii:session"
		],
		strategies: []
	},
	"owasp:api:05": {
		plugins: [
			"bfla",
			"bola",
			"rbac"
		],
		strategies: []
	},
	"owasp:api:06": {
		plugins: ["harmful:misinformation-disinformation", "overreliance"],
		strategies: []
	},
	"owasp:api:07": {
		plugins: ["shell-injection", "sql-injection"],
		strategies: []
	},
	"owasp:api:08": {
		plugins: [
			"harmful:privacy",
			"pii:api-db",
			"pii:session"
		],
		strategies: []
	},
	"owasp:api:09": {
		plugins: ["harmful:specialized-advice", "overreliance"],
		strategies: []
	},
	"owasp:api:10": {
		plugins: ["debug-access", "harmful:privacy"],
		strategies: []
	}
};
/**
* OWASP Top 10 for Agentic Applications (December 2025)
* The official OWASP Top 10 list for AI agent security risks.
* Announced during Black Hat Europe 2025 and the OWASP Agentic Security Summit.
*
* @see https://genai.owasp.org/resource/owasp-top-10-for-agentic-applications/
*/
const OWASP_AGENTIC_TOP_10_MAPPING = {
	"owasp:agentic:asi01": {
		plugins: [
			"hijacking",
			"system-prompt-override",
			"indirect-prompt-injection",
			"intent"
		],
		strategies: [
			"jailbreak",
			"jailbreak-templates",
			"jailbreak:composite"
		]
	},
	"owasp:agentic:asi02": {
		plugins: [
			"excessive-agency",
			"mcp",
			"tool-discovery"
		],
		strategies: ["jailbreak", "jailbreak-templates"]
	},
	"owasp:agentic:asi03": {
		plugins: [
			"rbac",
			"bfla",
			"bola",
			"imitation"
		],
		strategies: ["jailbreak", "jailbreak-templates"]
	},
	"owasp:agentic:asi04": {
		plugins: ["indirect-prompt-injection", "mcp"],
		strategies: ["jailbreak-templates"]
	},
	"owasp:agentic:asi05": {
		plugins: [
			"shell-injection",
			"sql-injection",
			"harmful:cybercrime:malicious-code",
			"ssrf"
		],
		strategies: ["jailbreak", "jailbreak-templates"]
	},
	"owasp:agentic:asi06": {
		plugins: [
			"agentic:memory-poisoning",
			"cross-session-leak",
			"indirect-prompt-injection"
		],
		strategies: ["jailbreak", "crescendo"]
	},
	"owasp:agentic:asi07": {
		plugins: [
			"indirect-prompt-injection",
			"hijacking",
			"imitation"
		],
		strategies: ["jailbreak-templates"]
	},
	"owasp:agentic:asi08": {
		plugins: [
			"hallucination",
			"harmful:misinformation-disinformation",
			"divergent-repetition"
		],
		strategies: ["jailbreak", "jailbreak-templates"]
	},
	"owasp:agentic:asi09": {
		plugins: [
			"overreliance",
			"imitation",
			"harmful:misinformation-disinformation"
		],
		strategies: ["crescendo"]
	},
	"owasp:agentic:asi10": {
		plugins: [
			"excessive-agency",
			"hijacking",
			"rbac",
			"goal-misalignment"
		],
		strategies: ["jailbreak", "crescendo"]
	}
};
/**
* Maps each major phase of the OWASP GenAI Red Teaming Blueprint
* to relevant Promptfoo plugins and strategies for automated testing.
*/
const OWASP_LLM_RED_TEAM_MAPPING = {
	"owasp:llm:redteam:model": {
		plugins: [...FOUNDATION_PLUGINS],
		strategies: [
			"jailbreak",
			"jailbreak:tree",
			"jailbreak:composite",
			"crescendo",
			"goat",
			"jailbreak-templates",
			"best-of-n"
		]
	},
	"owasp:llm:redteam:implementation": {
		plugins: [
			...PII_PLUGINS,
			"prompt-extraction",
			"harmful:privacy",
			"rbac",
			"bfla",
			"bola",
			"ascii-smuggling"
		],
		strategies: [
			"jailbreak",
			"jailbreak:tree",
			"jailbreak:composite",
			"jailbreak-templates",
			"hex",
			"base64",
			"homoglyph",
			"leetspeak",
			"morse",
			"piglatin",
			"rot13"
		]
	},
	"owasp:llm:redteam:system": {
		plugins: [
			"shell-injection",
			"sql-injection",
			"ssrf",
			"debug-access",
			"tool-discovery",
			"indirect-prompt-injection",
			"hijacking"
		],
		strategies: [
			"jailbreak",
			"jailbreak:tree",
			"jailbreak:composite",
			"crescendo",
			"goat",
			"gcg"
		]
	},
	"owasp:llm:redteam:runtime": {
		plugins: [
			"excessive-agency",
			"overreliance",
			"pliny",
			"competitors",
			"imitation",
			"politics",
			"religion",
			"harmful:radicalization",
			"harmful:self-harm",
			"harmful:hate"
		],
		strategies: [
			"crescendo",
			"goat",
			"jailbreak:tree",
			"jailbreak:composite",
			"jailbreak-templates"
		]
	}
};
const NIST_AI_RMF_MAPPING = {
	"nist:ai:measure:1.1": {
		plugins: ["excessive-agency", "harmful:misinformation-disinformation"],
		strategies: ["jailbreak", "jailbreak-templates"]
	},
	"nist:ai:measure:1.2": {
		plugins: ["excessive-agency", "harmful:misinformation-disinformation"],
		strategies: ["jailbreak", "jailbreak-templates"]
	},
	"nist:ai:measure:2.1": {
		plugins: [
			"harmful:privacy",
			"pii:api-db",
			"pii:direct",
			"pii:session",
			"pii:social"
		],
		strategies: []
	},
	"nist:ai:measure:2.2": {
		plugins: [
			"harmful:privacy",
			"pii:api-db",
			"pii:direct",
			"pii:session",
			"pii:social"
		],
		strategies: []
	},
	"nist:ai:measure:2.3": {
		plugins: ["excessive-agency"],
		strategies: []
	},
	"nist:ai:measure:2.4": {
		plugins: ["excessive-agency", "harmful:misinformation-disinformation"],
		strategies: ["jailbreak", "jailbreak-templates"]
	},
	"nist:ai:measure:2.5": {
		plugins: ["excessive-agency"],
		strategies: []
	},
	"nist:ai:measure:2.6": {
		plugins: [
			"harmful:chemical-biological-weapons",
			"harmful:indiscriminate-weapons",
			"harmful:unsafe-practices"
		],
		strategies: []
	},
	"nist:ai:measure:2.7": {
		plugins: [
			"harmful:cybercrime",
			"shell-injection",
			"sql-injection"
		],
		strategies: ["jailbreak", "jailbreak-templates"]
	},
	"nist:ai:measure:2.8": {
		plugins: [
			"bfla",
			"bola",
			"rbac"
		],
		strategies: []
	},
	"nist:ai:measure:2.9": {
		plugins: ["excessive-agency"],
		strategies: []
	},
	"nist:ai:measure:2.10": {
		plugins: [
			"harmful:privacy",
			"pii:api-db",
			"pii:direct",
			"pii:session",
			"pii:social"
		],
		strategies: []
	},
	"nist:ai:measure:2.11": {
		plugins: [
			"harmful:harassment-bullying",
			"harmful:hate",
			"harmful:insults"
		],
		strategies: []
	},
	"nist:ai:measure:2.12": {
		plugins: [],
		strategies: []
	},
	"nist:ai:measure:2.13": {
		plugins: ["excessive-agency"],
		strategies: []
	},
	"nist:ai:measure:3.1": {
		plugins: ["excessive-agency", "harmful:misinformation-disinformation"],
		strategies: ["jailbreak", "jailbreak-templates"]
	},
	"nist:ai:measure:3.2": {
		plugins: ["excessive-agency"],
		strategies: []
	},
	"nist:ai:measure:3.3": {
		plugins: ["excessive-agency"],
		strategies: []
	},
	"nist:ai:measure:4.1": {
		plugins: ["excessive-agency"],
		strategies: []
	},
	"nist:ai:measure:4.2": {
		plugins: ["excessive-agency", "harmful:misinformation-disinformation"],
		strategies: []
	},
	"nist:ai:measure:4.3": {
		plugins: ["excessive-agency"],
		strategies: []
	}
};
const MITRE_ATLAS_MAPPING = {
	"mitre:atlas:exfiltration": {
		plugins: [
			"ascii-smuggling",
			"harmful:privacy",
			"indirect-prompt-injection",
			"pii:api-db",
			"pii:direct",
			"pii:session",
			"pii:social",
			"prompt-extraction"
		],
		strategies: []
	},
	"mitre:atlas:impact": {
		plugins: [
			"excessive-agency",
			"harmful",
			"hijacking",
			"imitation"
		],
		strategies: ["crescendo"]
	},
	"mitre:atlas:initial-access": {
		plugins: [
			"debug-access",
			"harmful:cybercrime",
			"shell-injection",
			"sql-injection",
			"ssrf"
		],
		strategies: [
			"base64",
			"jailbreak",
			"leetspeak",
			"jailbreak-templates",
			"rot13"
		]
	},
	"mitre:atlas:ml-attack-staging": {
		plugins: [
			"ascii-smuggling",
			"excessive-agency",
			"hallucination",
			"indirect-prompt-injection"
		],
		strategies: ["jailbreak", "jailbreak:tree"]
	},
	"mitre:atlas:reconnaissance": {
		plugins: [
			"competitors",
			"policy",
			"prompt-extraction",
			"rbac"
		],
		strategies: []
	},
	"mitre:atlas:resource-development": {
		plugins: [
			"harmful:cybercrime",
			"harmful:illegal-drugs",
			"harmful:indiscriminate-weapons"
		],
		strategies: []
	}
};
/**
*  EU Artificial Intelligence Act
*  ▸ Art. 5  (Prohibited AI practices)           – unacceptable-risk
*  ▸ Annex III (High-risk AI systems, Art. 6(2)) – high-risk
*
*  Sources:
*   * Art. 5 list of prohibitions  [oai_citation:0‡Artificial Intelligence Act](https://artificialintelligenceact.eu/article/5/?utm_source=chatgpt.com)
*   * Annex III high-risk categories  [oai_citation:1‡Lexology](https://www.lexology.com/library/detail.aspx?g=ec2aab25-67aa-4635-87a0-fc43d9fd1f51&utm_source=chatgpt.com)
*/
const EU_AI_ACT_MAPPING = {
	"eu:ai-act:art5:subliminal-manipulation": {
		plugins: [
			"hijacking",
			"intent",
			"excessive-agency"
		],
		strategies: [
			"jailbreak",
			"jailbreak:tree",
			"jailbreak:composite",
			"jailbreak-templates"
		]
	},
	"eu:ai-act:art5:exploitation-of-vulnerabilities": {
		plugins: [
			"hijacking",
			"imitation",
			"harmful:misinformation-disinformation"
		],
		strategies: []
	},
	"eu:ai-act:art5:social-scoring": {
		plugins: ["harmful:misinformation-disinformation", "overreliance"],
		strategies: []
	},
	"eu:ai-act:art5:biometric-categorisation": {
		plugins: [
			"pii:direct",
			"pii:session",
			"harmful:privacy"
		],
		strategies: []
	},
	"eu:ai-act:art5:remote-biometric-id-live": {
		plugins: [
			"pii:session",
			"pii:direct",
			"harmful:privacy"
		],
		strategies: []
	},
	"eu:ai-act:art5:remote-biometric-id-post": {
		plugins: [
			"pii:api-db",
			"pii:direct",
			"harmful:privacy"
		],
		strategies: []
	},
	"eu:ai-act:annex3:biometric-id": {
		plugins: [
			"pii:direct",
			"pii:session",
			"harmful:privacy"
		],
		strategies: []
	},
	"eu:ai-act:annex3:critical-infrastructure": {
		plugins: [
			"shell-injection",
			"sql-injection",
			"ssrf",
			"excessive-agency"
		],
		strategies: ["jailbreak", "jailbreak-templates"]
	},
	"eu:ai-act:annex3:education": {
		plugins: [
			"harmful:misinformation-disinformation",
			"hallucination",
			"overreliance"
		],
		strategies: []
	},
	"eu:ai-act:annex3:employment": {
		plugins: [
			"imitation",
			"pii:direct",
			"overreliance"
		],
		strategies: []
	},
	"eu:ai-act:annex3:essential-services": {
		plugins: [
			"pii:direct",
			"pii:session",
			"excessive-agency"
		],
		strategies: []
	},
	"eu:ai-act:annex3:law-enforcement": {
		plugins: [
			"pii:direct",
			"pii:api-db",
			"harmful:privacy"
		],
		strategies: []
	},
	"eu:ai-act:annex3:migration-border": {
		plugins: [
			"pii:direct",
			"harmful:hate",
			"harmful:privacy"
		],
		strategies: []
	},
	"eu:ai-act:annex3:justice-democracy": {
		plugins: [
			"hallucination",
			"harmful:misinformation-disinformation",
			"pii:direct"
		],
		strategies: []
	}
};
/**
* ISO/IEC 42001 – AI Management System (AIMS) framework risk areas
* Covers key risk domains: human oversight, fairness, privacy, robustness, security, ethics, transparency.
*/
const ISO_42001_MAPPING = {
	"iso:42001:accountability": {
		plugins: [
			"excessive-agency",
			"overreliance",
			"hijacking"
		],
		strategies: []
	},
	"iso:42001:fairness": {
		plugins: [
			"bias:age",
			"bias:disability",
			"bias:gender",
			"bias:race",
			"harmful:hate"
		],
		strategies: []
	},
	"iso:42001:privacy": {
		plugins: [
			"harmful:privacy",
			"pii:api-db",
			"pii:direct",
			"pii:session",
			"pii:social"
		],
		strategies: []
	},
	"iso:42001:robustness": {
		plugins: ["ascii-smuggling", "prompt-extraction"],
		strategies: [
			"jailbreak",
			"jailbreak:composite",
			"jailbreak:tree"
		]
	},
	"iso:42001:security": {
		plugins: [
			"shell-injection",
			"sql-injection",
			"ssrf",
			"debug-access"
		],
		strategies: [
			"jailbreak",
			"jailbreak:composite",
			"base64",
			"rot13"
		]
	},
	"iso:42001:safety": {
		plugins: [
			"harmful:chemical-biological-weapons",
			"harmful:child-exploitation",
			"harmful:violent-crime",
			"harmful:cybercrime",
			"harmful:cybercrime:malicious-code"
		],
		strategies: [
			"jailbreak",
			"jailbreak:composite",
			"jailbreak:tree"
		]
	},
	"iso:42001:transparency": {
		plugins: [
			"harmful:misinformation-disinformation",
			"hallucination",
			"imitation",
			"unverifiable-claims",
			"politics",
			"religion"
		],
		strategies: []
	}
};
/**
* EU General Data Protection Regulation (GDPR)
* Maps key GDPR articles to relevant Promptfoo plugins for testing AI/LLM systems
* for compliance with data protection requirements.
*
* Sources:
*  * GDPR full text: https://gdpr-info.eu/
*/
const GDPR_MAPPING = {
	"gdpr:art5": {
		plugins: [
			"harmful:privacy",
			"pii:api-db",
			"pii:direct",
			"pii:session",
			"pii:social",
			"hallucination",
			"harmful:misinformation-disinformation"
		],
		strategies: []
	},
	"gdpr:art9": {
		plugins: [
			"pii:direct",
			"pii:social",
			"harmful:privacy",
			"bias:age",
			"bias:disability",
			"bias:gender",
			"bias:race"
		],
		strategies: []
	},
	"gdpr:art15": {
		plugins: [
			"pii:api-db",
			"pii:session",
			"rbac",
			"bola",
			"bfla"
		],
		strategies: []
	},
	"gdpr:art17": {
		plugins: [
			"pii:api-db",
			"pii:direct",
			"pii:session",
			"harmful:privacy",
			"cross-session-leak"
		],
		strategies: []
	},
	"gdpr:art22": {
		plugins: [
			"bias:age",
			"bias:disability",
			"bias:gender",
			"bias:race",
			"harmful:hate",
			"overreliance",
			"hallucination"
		],
		strategies: []
	},
	"gdpr:art25": {
		plugins: [
			"harmful:privacy",
			"pii:api-db",
			"pii:direct",
			"pii:session",
			"pii:social",
			"prompt-extraction"
		],
		strategies: []
	},
	"gdpr:art32": {
		plugins: [
			"shell-injection",
			"sql-injection",
			"ssrf",
			"debug-access",
			"harmful:cybercrime",
			"rbac",
			"bfla",
			"bola"
		],
		strategies: []
	}
};
const ALIASED_PLUGINS = [
	"mitre:atlas",
	"nist:ai",
	"nist:ai:measure",
	"owasp:api",
	"owasp:llm",
	"owasp:llm:redteam:model",
	"owasp:llm:redteam:implementation",
	"owasp:llm:redteam:system",
	"owasp:llm:redteam:runtime",
	"owasp:agentic",
	"toxicity",
	"bias",
	"misinformation",
	"illegal-activity",
	"personal-safety",
	"tool-discovery:multi-turn",
	"eu:ai-act",
	"iso:42001",
	"gdpr",
	...Object.keys(MITRE_ATLAS_MAPPING),
	...Object.keys(NIST_AI_RMF_MAPPING),
	...Object.keys(OWASP_API_TOP_10_MAPPING),
	...Object.keys(OWASP_LLM_TOP_10_MAPPING),
	...Object.keys(OWASP_AGENTIC_TOP_10_MAPPING),
	...Object.keys(EU_AI_ACT_MAPPING),
	...Object.keys(ISO_42001_MAPPING),
	...Object.keys(GDPR_MAPPING)
];
const ALIASED_PLUGIN_MAPPINGS = {
	"mitre:atlas": MITRE_ATLAS_MAPPING,
	"nist:ai:measure": NIST_AI_RMF_MAPPING,
	"owasp:api": OWASP_API_TOP_10_MAPPING,
	"owasp:llm": OWASP_LLM_TOP_10_MAPPING,
	"owasp:llm:redteam": OWASP_LLM_RED_TEAM_MAPPING,
	"owasp:agentic": OWASP_AGENTIC_TOP_10_MAPPING,
	"eu:ai-act": EU_AI_ACT_MAPPING,
	"iso:42001": ISO_42001_MAPPING,
	gdpr: GDPR_MAPPING,
	"tool-discovery:multi-turn": { "tool-discovery:multi-turn": {
		plugins: ["tool-discovery"],
		strategies: []
	} },
	toxicity: { toxicity: {
		plugins: [
			"harmful:hate",
			"harmful:harassment-bullying",
			"harmful:insults",
			"harmful:profanity",
			"harmful:graphic-content",
			"harmful:sexual-content"
		],
		strategies: []
	} },
	bias: { bias: {
		plugins: [
			"politics",
			"religion",
			"bias:age",
			"bias:disability",
			"bias:gender",
			"bias:race"
		],
		strategies: []
	} },
	misinformation: { misinformation: {
		plugins: [
			"harmful:misinformation-disinformation",
			"hallucination",
			"harmful:radicalization",
			"imitation"
		],
		strategies: []
	} },
	"illegal-activity": { "illegal-activity": {
		plugins: [
			"harmful:violent-crime",
			"harmful:non-violent-crime",
			"harmful:sex-crime",
			"harmful:cybercrime",
			"harmful:illegal-activities",
			"harmful:illegal-drugs",
			"harmful:illegal-drugs:meth",
			"harmful:chemical-biological-weapons",
			"harmful:indiscriminate-weapons",
			"harmful:weapons:ied"
		],
		strategies: []
	} }
};

//#endregion
//#region src/redteam/constants/metadata.ts
const Severity = {
	Critical: "critical",
	High: "high",
	Medium: "medium",
	Low: "low",
	Informational: "informational"
};
const SeveritySchema = zod.z.enum([
	"critical",
	"high",
	"medium",
	"low",
	"informational"
]);
const severityDisplayNames = {
	[Severity.Critical]: "Critical",
	[Severity.High]: "High",
	[Severity.Medium]: "Medium",
	[Severity.Low]: "Low",
	[Severity.Informational]: "Informational"
};
const severityRiskScores = {
	[Severity.Critical]: 9,
	[Severity.High]: 7,
	[Severity.Medium]: 4,
	[Severity.Low]: 0,
	[Severity.Informational]: 0
};
const riskCategorySeverityMap = {
	["agentic:memory-poisoning"]: Severity.High,
	aegis: Severity.Medium,
	"ascii-smuggling": Severity.Low,
	beavertails: Severity.Low,
	bfla: Severity.High,
	bola: Severity.High,
	cca: Severity.High,
	ferpa: Severity.Medium,
	"financial:calculation-error": Severity.Low,
	"financial:compliance-violation": Severity.Medium,
	"financial:confidential-disclosure": Severity.High,
	"financial:counterfactual": Severity.Medium,
	"financial:data-leakage": Severity.Medium,
	"financial:defamation": Severity.Medium,
	"financial:hallucination": Severity.Low,
	"financial:impartiality": Severity.Medium,
	"financial:misconduct": Severity.High,
	"financial:sycophancy": Severity.Low,
	"goal-misalignment": Severity.Low,
	competitors: Severity.Low,
	contracts: Severity.Medium,
	coppa: Severity.High,
	"cross-session-leak": Severity.Medium,
	cyberseceval: Severity.Medium,
	donotanswer: Severity.Medium,
	"debug-access": Severity.High,
	default: Severity.Low,
	mcp: Severity.High,
	"medical:anchoring-bias": Severity.High,
	"medical:hallucination": Severity.Critical,
	"medical:incorrect-knowledge": Severity.Critical,
	"medical:off-label-use": Severity.High,
	"medical:prioritization-error": Severity.High,
	"medical:sycophancy": Severity.Medium,
	"off-topic": Severity.Medium,
	"divergent-repetition": Severity.Medium,
	"excessive-agency": Severity.Medium,
	"tool-discovery": Severity.Low,
	foundation: Severity.Medium,
	"guardrails-eval": Severity.Medium,
	hallucination: Severity.Medium,
	harmbench: Severity.Medium,
	"toxic-chat": Severity.Medium,
	harmful: Severity.Medium,
	"bias:age": Severity.Low,
	"bias:disability": Severity.Low,
	"bias:gender": Severity.Low,
	"bias:race": Severity.Low,
	bias: Severity.Low,
	medical: Severity.High,
	pharmacy: Severity.High,
	insurance: Severity.High,
	financial: Severity.High,
	ecommerce: Severity.High,
	"harmful:chemical-biological-weapons": Severity.High,
	"harmful:child-exploitation": Severity.Critical,
	"harmful:copyright-violations": Severity.Low,
	"harmful:cybercrime": Severity.Low,
	"harmful:cybercrime:malicious-code": Severity.Low,
	"harmful:graphic-content": Severity.Medium,
	"harmful:harassment-bullying": Severity.Low,
	"harmful:hate": Severity.Critical,
	"harmful:illegal-activities": Severity.Medium,
	"harmful:illegal-drugs": Severity.Medium,
	"harmful:illegal-drugs:meth": Severity.Low,
	"harmful:indiscriminate-weapons": Severity.Medium,
	"harmful:insults": Severity.Low,
	"harmful:intellectual-property": Severity.Medium,
	"harmful:misinformation-disinformation": Severity.Medium,
	"harmful:non-violent-crime": Severity.Medium,
	"harmful:privacy": Severity.High,
	"harmful:profanity": Severity.Low,
	"harmful:radicalization": Severity.Low,
	"harmful:self-harm": Severity.Critical,
	"harmful:sex-crime": Severity.High,
	"harmful:sexual-content": Severity.Medium,
	"harmful:specialized-advice": Severity.Medium,
	"harmful:unsafe-practices": Severity.Low,
	"harmful:violent-crime": Severity.High,
	"harmful:weapons:ied": Severity.Low,
	hijacking: Severity.High,
	imitation: Severity.Low,
	"indirect-prompt-injection": Severity.High,
	"insurance:coverage-discrimination": Severity.Critical,
	"insurance:network-misinformation": Severity.High,
	"insurance:phi-disclosure": Severity.Critical,
	"ecommerce:pci-dss": Severity.Critical,
	"ecommerce:compliance-bypass": Severity.High,
	"ecommerce:order-fraud": Severity.High,
	"ecommerce:price-manipulation": Severity.High,
	telecom: Severity.Critical,
	"telecom:cpni-disclosure": Severity.Critical,
	"telecom:location-disclosure": Severity.Critical,
	"telecom:account-takeover": Severity.Critical,
	"telecom:e911-misinformation": Severity.Critical,
	"telecom:tcpa-violation": Severity.High,
	"telecom:unauthorized-changes": Severity.High,
	"telecom:fraud-enablement": Severity.High,
	"telecom:porting-misinformation": Severity.High,
	"telecom:billing-misinformation": Severity.Medium,
	"telecom:coverage-misinformation": Severity.Medium,
	"telecom:law-enforcement-request-handling": Severity.Medium,
	"telecom:accessibility-violation": Severity.Medium,
	intent: Severity.High,
	overreliance: Severity.Low,
	"pharmacy:controlled-substance-compliance": Severity.High,
	"pharmacy:dosage-calculation": Severity.Critical,
	"pharmacy:drug-interaction": Severity.Critical,
	pii: Severity.High,
	"pii:api-db": Severity.High,
	"pii:direct": Severity.High,
	"pii:session": Severity.High,
	"pii:social": Severity.High,
	pliny: Severity.Medium,
	policy: Severity.High,
	politics: Severity.Low,
	"prompt-extraction": Severity.Medium,
	"rag-document-exfiltration": Severity.Medium,
	"rag-poisoning": Severity.Medium,
	"rag-source-attribution": Severity.High,
	rbac: Severity.High,
	"reasoning-dos": Severity.Low,
	religion: Severity.Low,
	"shell-injection": Severity.High,
	"special-token-injection": Severity.Medium,
	"sql-injection": Severity.High,
	ssrf: Severity.High,
	"system-prompt-override": Severity.High,
	unsafebench: Severity.Medium,
	"unverifiable-claims": Severity.Medium,
	vlguard: Severity.Medium,
	vlsu: Severity.Medium,
	wordplay: Severity.Low,
	xstest: Severity.Low
};
const riskCategories = {
	"Security & Access Control": [
		"ascii-smuggling",
		"bfla",
		"bola",
		"cca",
		"debug-access",
		"hijacking",
		"indirect-prompt-injection",
		"rbac",
		"reasoning-dos",
		"shell-injection",
		"special-token-injection",
		"sql-injection",
		"ssrf",
		"system-prompt-override",
		"tool-discovery",
		"mcp",
		"cross-session-leak",
		"divergent-repetition",
		"harmful:privacy",
		"insurance:phi-disclosure",
		"pii:api-db",
		"pii:direct",
		"pii:session",
		"pii:social",
		"pii",
		"prompt-extraction",
		"rag-document-exfiltration",
		"rag-poisoning",
		"rag-source-attribution",
		"agentic:memory-poisoning"
	],
	"Compliance & Legal": [
		"contracts",
		"coppa",
		"ferpa",
		"harmful:chemical-biological-weapons",
		"harmful:copyright-violations",
		"harmful:cybercrime:malicious-code",
		"harmful:cybercrime",
		"harmful:illegal-activities",
		"harmful:illegal-drugs:meth",
		"harmful:illegal-drugs",
		"harmful:indiscriminate-weapons",
		"harmful:intellectual-property",
		"harmful:non-violent-crime",
		"harmful:sex-crime",
		"harmful:specialized-advice",
		"harmful:unsafe-practices",
		"harmful:violent-crime",
		"harmful:weapons:ied",
		"insurance:coverage-discrimination",
		"insurance:network-misinformation"
	],
	"Trust & Safety": [
		"bias:age",
		"bias:disability",
		"bias:gender",
		"bias:race",
		"harmful:child-exploitation",
		"harmful:graphic-content",
		"harmful:harassment-bullying",
		"harmful:hate",
		"harmful:insults",
		"harmful:profanity",
		"harmful:radicalization",
		"harmful:self-harm",
		"harmful:sexual-content",
		"wordplay"
	],
	Brand: [
		"competitors",
		"excessive-agency",
		"goal-misalignment",
		"hallucination",
		"harmful:misinformation-disinformation",
		"hijacking",
		"imitation",
		"intent",
		"off-topic",
		"overreliance",
		"policy",
		"politics",
		"religion",
		"unverifiable-claims"
	],
	"Domain-Specific Risks": [
		"ecommerce:pci-dss",
		"ecommerce:compliance-bypass",
		"ecommerce:order-fraud",
		"ecommerce:price-manipulation",
		"financial:calculation-error",
		"financial:compliance-violation",
		"financial:confidential-disclosure",
		"financial:counterfactual",
		"financial:data-leakage",
		"financial:defamation",
		"financial:hallucination",
		"financial:impartiality",
		"financial:misconduct",
		"financial:sycophancy",
		"medical:hallucination",
		"medical:anchoring-bias",
		"medical:incorrect-knowledge",
		"medical:off-label-use",
		"medical:prioritization-error",
		"medical:sycophancy",
		"pharmacy:controlled-substance-compliance",
		"pharmacy:dosage-calculation",
		"pharmacy:drug-interaction",
		"telecom:cpni-disclosure",
		"telecom:location-disclosure",
		"telecom:account-takeover",
		"telecom:e911-misinformation",
		"telecom:tcpa-violation",
		"telecom:unauthorized-changes",
		"telecom:fraud-enablement",
		"telecom:porting-misinformation",
		"telecom:billing-misinformation",
		"telecom:coverage-misinformation",
		"telecom:law-enforcement-request-handling",
		"telecom:accessibility-violation"
	],
	Datasets: [
		"aegis",
		"beavertails",
		"cyberseceval",
		"donotanswer",
		"harmbench",
		"toxic-chat",
		"pliny",
		"unsafebench",
		"vlguard",
		"vlsu",
		"xstest"
	]
};
const categoryMapReverse = Object.entries(riskCategories).reduce((acc, [category, harms]) => {
	harms.forEach((harm) => {
		acc[harm] = category;
	});
	return acc;
}, {});
const categoryLabels = Object.keys(categoryMapReverse);
const categoryAliases = {
	["agentic:memory-poisoning"]: "AgenticMemoryPoisoning",
	aegis: "Aegis",
	"ascii-smuggling": "AsciiSmuggling",
	beavertails: "BeaverTails",
	bfla: "BFLAEnforcement",
	bola: "BOLAEnforcement",
	cca: "CCAEnforcement",
	competitors: "CompetitorEndorsement",
	contracts: "ContractualCommitment",
	coppa: "COPPACompliance",
	"cross-session-leak": "CrossSessionLeak",
	cyberseceval: "CyberSecEval",
	donotanswer: "DoNotAnswer",
	"debug-access": "DebugAccess",
	default: "Default",
	ferpa: "FERPACompliance",
	mcp: "MCP",
	"medical:anchoring-bias": "MedicalAnchoringBias",
	"medical:hallucination": "Medical Hallucination",
	"medical:incorrect-knowledge": "MedicalIncorrectKnowledge",
	"medical:off-label-use": "MedicalOffLabelUse",
	"medical:prioritization-error": "MedicalPrioritizationError",
	"medical:sycophancy": "MedicalSycophancy",
	"ecommerce:compliance-bypass": "EcommerceComplianceBypass",
	"ecommerce:order-fraud": "EcommerceOrderFraud",
	"ecommerce:pci-dss": "EcommercePciDss",
	"ecommerce:price-manipulation": "EcommercePriceManipulation",
	"financial:calculation-error": "FinancialCalculationError",
	"financial:compliance-violation": "FinancialComplianceViolation",
	"financial:confidential-disclosure": "FinancialConfidentialDisclosure",
	"financial:counterfactual": "FinancialCounterfactual",
	"financial:data-leakage": "FinancialDataLeakage",
	"financial:defamation": "FinancialDefamation",
	"financial:hallucination": "FinancialHallucination",
	"financial:impartiality": "FinancialImpartiality",
	"financial:misconduct": "FinancialMisconduct",
	"financial:sycophancy": "FinancialSycophancy",
	"goal-misalignment": "GoalMisalignment",
	"off-topic": "OffTopic",
	"pharmacy:controlled-substance-compliance": "PharmacyControlledSubstanceCompliance",
	"pharmacy:dosage-calculation": "PharmacyDosageCalculation",
	"pharmacy:drug-interaction": "PharmacyDrugInteraction",
	"divergent-repetition": "DivergentRepetition",
	"excessive-agency": "ExcessiveAgency",
	"tool-discovery": "ToolDiscovery",
	foundation: "Foundation",
	"guardrails-eval": "GuardrailsEvaluation",
	hallucination: "Hallucination",
	harmbench: "Harmbench",
	"toxic-chat": "ToxicChat",
	harmful: "Harmful",
	"bias:age": "Age Bias",
	"bias:disability": "Disability Bias",
	"bias:gender": "Gender Bias",
	"bias:race": "Race Bias",
	bias: "Bias Detection",
	medical: "Medical Safety",
	pharmacy: "Pharmacy Safety",
	insurance: "Insurance Safety",
	financial: "Financial Safety",
	ecommerce: "E-commerce Safety",
	telecom: "Telecommunications Safety",
	"telecom:cpni-disclosure": "TelecomCpniDisclosure",
	"telecom:location-disclosure": "TelecomLocationDisclosure",
	"telecom:account-takeover": "TelecomAccountTakeover",
	"telecom:e911-misinformation": "TelecomE911Misinformation",
	"telecom:tcpa-violation": "TelecomTcpaViolation",
	"telecom:unauthorized-changes": "TelecomUnauthorizedChanges",
	"telecom:fraud-enablement": "TelecomFraudEnablement",
	"telecom:porting-misinformation": "TelecomPortingMisinformation",
	"telecom:billing-misinformation": "TelecomBillingMisinformation",
	"telecom:coverage-misinformation": "TelecomCoverageMisinformation",
	"telecom:law-enforcement-request-handling": "TelecomLawEnforcementRequestHandling",
	"telecom:accessibility-violation": "TelecomAccessibilityViolation",
	"harmful:chemical-biological-weapons": "Chemical & Biological Weapons",
	"harmful:child-exploitation": "Child Exploitation",
	"harmful:copyright-violations": "Copyright Violations - Copyrighted text",
	"harmful:cybercrime": "Cybercrime",
	"harmful:cybercrime:malicious-code": "Malicious Code",
	"harmful:graphic-content": "Graphic Content",
	"harmful:harassment-bullying": "Harassment",
	"harmful:hate": "Hate",
	"harmful:illegal-activities": "Illegal Activities - Fraud & scams",
	"harmful:illegal-drugs": "Illegal Drugs",
	"harmful:illegal-drugs:meth": "Methamphetamine",
	"harmful:indiscriminate-weapons": "Indiscriminate Weapons",
	"harmful:insults": "Insults and personal attacks",
	"harmful:intellectual-property": "Intellectual Property violation",
	"harmful:misinformation-disinformation": "Misinformation & Disinformation - Harmful lies and propaganda",
	"harmful:non-violent-crime": "Non-Violent Crimes",
	"harmful:privacy": "Privacy violations",
	"harmful:profanity": "Requests containing profanity",
	"harmful:radicalization": "Radicalization",
	"harmful:self-harm": "Self-Harm",
	"harmful:sex-crime": "Sex Crimes",
	"harmful:sexual-content": "Sexual Content",
	"harmful:specialized-advice": "Specialized Advice - Financial",
	"harmful:unsafe-practices": "Promotion of unsafe practices",
	"harmful:violent-crime": "Violent Crimes",
	"harmful:weapons:ied": "Improvised Explosive Devices",
	hijacking: "Hijacking",
	imitation: "Imitation",
	"indirect-prompt-injection": "Indirect Prompt Injection",
	"insurance:coverage-discrimination": "InsuranceCoverageDiscrimination",
	"insurance:network-misinformation": "InsuranceNetworkMisinformation",
	"insurance:phi-disclosure": "InsurancePhiDisclosure",
	intent: "Intent",
	overreliance: "Overreliance",
	pii: "PIILeak",
	"pii:api-db": "PIILeak",
	"pii:direct": "PIILeak",
	"pii:session": "PIILeak",
	"pii:social": "PIILeak",
	pliny: "Pliny",
	policy: "PolicyViolation",
	politics: "PoliticalStatement",
	"prompt-extraction": "PromptExtraction",
	"rag-document-exfiltration": "RAG Document Exfiltration",
	"rag-poisoning": "RAG Poisoning",
	"rag-source-attribution": "RAGSourceAttribution",
	rbac: "RbacEnforcement",
	"reasoning-dos": "Reasoning DoS",
	religion: "Religion",
	"shell-injection": "ShellInjection",
	"special-token-injection": "SpecialTokenInjection",
	"sql-injection": "SqlInjection",
	ssrf: "SSRFEnforcement",
	"system-prompt-override": "System Prompt Override",
	unsafebench: "UnsafeBench",
	"unverifiable-claims": "Unverifiable Claims",
	vlguard: "VLGuard",
	vlsu: "VLSU",
	wordplay: "Wordplay",
	xstest: "XSTest"
};
const categoryAliasesReverse = Object.entries(categoryAliases).reduce((acc, [key, value]) => {
	acc[value] = key;
	return acc;
}, {});
const pluginDescriptions = {
	["agentic:memory-poisoning"]: "Tests whether an agent is vulnerable to memory poisoning attacks",
	aegis: "Tests content safety handling using NVIDIA's Aegis dataset",
	"ascii-smuggling": "Tests for ASCII-based prompt smuggling vulnerabilities",
	beavertails: "Tests handling of malicious prompts from the BeaverTails dataset",
	bfla: "Evaluates function-level authorization controls to identify privilege escalation vulnerabilities (OWASP API Security Top 10 #5)",
	bola: "Tests object-level authorization mechanisms to detect unauthorized data access vulnerabilities (OWASP API Security Top 10 #1)",
	cca: "Tests for vulnerability to Context Compliance Attacks using fabricated conversation history",
	competitors: "Assesses system protection against unauthorized competitor endorsements and brand security risks",
	contracts: "Evaluates safeguards against unauthorized contractual commitments and legal exposure",
	coppa: "Tests for COPPA (Children's Online Privacy Protection Act) compliance violations, ensuring proper protection of children's data and privacy",
	"cross-session-leak": "Tests for information leakage vulnerabilities between different user sessions",
	cyberseceval: "Tests prompt injection attacks from Meta's CyberSecEval dataset",
	donotanswer: "Tests for vulnerabilities to Do Not Answer attacks",
	"debug-access": "Identifies exposed debugging interfaces and unauthorized command execution vectors",
	default: "Executes comprehensive baseline security testing across multiple risk categories",
	"divergent-repetition": "Tests repetitive patterns that can cause the model to diverge from normal behavior and leak training data",
	"excessive-agency": "Evaluates system boundary enforcement and unauthorized action prevention",
	"tool-discovery": "Tests for enumeration of available tools and function calls",
	ferpa: "Tests for Family Educational Rights and Privacy Act compliance",
	foundation: "Tests a collection of plugins designed to run against foundation models",
	hallucination: "Tests system resilience against false information generation and propagation",
	harmbench: "Tests for harmful content, illegal activities, misinformation using the HarmBench dataset from the Center for AI Safety (CAIS)",
	"toxic-chat": "Tests handling of toxic user prompts from the ToxicChat dataset",
	harmful: "Comprehensive suite for testing handling of various categories of malicious content",
	"bias:age": "Tests handling of age bias in responses, stereotypes, and discrimination",
	"bias:disability": "Tests handling of disability bias in responses, stereotypes, and discrimination",
	"bias:gender": "Tests handling of gender bias in responses, stereotypes, and discrimination",
	"bias:race": "Tests handling of race bias in responses, stereotypes, and discrimination",
	bias: "Unified bias detection across protected characteristics including age, disability, gender, and race",
	medical: "Comprehensive medical AI safety testing for healthcare-specific vulnerabilities including hallucination, anchoring bias, incorrect knowledge, off-label use, prioritization errors, and sycophancy",
	pharmacy: "Comprehensive pharmacy AI safety testing for pharmaceutical vulnerabilities including drug interactions, dosage calculations, and controlled substance compliance",
	insurance: "Comprehensive insurance AI safety testing for healthcare coverage vulnerabilities including coverage discrimination, network misinformation, and PHI disclosure",
	financial: "Comprehensive financial AI safety testing for financial services vulnerabilities including calculation errors, compliance violations, hallucination, and data leakage",
	ecommerce: "Comprehensive e-commerce AI safety testing for payment security and transaction integrity vulnerabilities including PCI DSS compliance, fraud detection, and price manipulation",
	telecom: "Comprehensive telecommunications AI safety testing across CPNI protection, account security, regulatory compliance (FCC, TCPA, CALEA), and telecom-specific fraud prevention",
	"telecom:cpni-disclosure": "Tests for unauthorized disclosure of Customer Proprietary Network Information (CPNI) including call records, service details, and billing information in violation of FCC 47 U.S.C. Section 222",
	"telecom:location-disclosure": "Tests for unauthorized disclosure of customer location data from cell tower connections, GPS, or network information",
	"telecom:account-takeover": "Tests for SIM swap vulnerabilities, authentication bypass, and account hijacking that could enable fraud or identity theft",
	"telecom:e911-misinformation": "Tests for incorrect or unsafe information about emergency calling, location accuracy, VoIP limitations, and E911 regulations (Kari's Law, RAY BAUM's Act)",
	"telecom:tcpa-violation": "Tests for TCPA violations including improper consent handling, Do Not Call list compliance, and illegal robocall/text facilitation",
	"telecom:unauthorized-changes": "Tests for slamming (unauthorized carrier switches) and cramming (unauthorized charges) vulnerabilities that violate FCC Section 258",
	"telecom:fraud-enablement": "Tests for telecom-specific fraud facilitation including caller ID spoofing, SIM box fraud, and service arbitrage schemes",
	"telecom:porting-misinformation": "Tests for incorrect number portability information, unauthorized port facilitation, or port-blocking that violates FCC LNP rules",
	"telecom:billing-misinformation": "Tests for incorrect billing information, hidden fees, or misleading price quotes that violate FCC Truth-in-Billing requirements",
	"telecom:coverage-misinformation": "Tests for false or misleading claims about network coverage, 5G availability, or roaming capabilities",
	"telecom:law-enforcement-request-handling": "Tests for improper handling of law enforcement data requests in violation of CALEA requirements and privacy laws",
	"telecom:accessibility-violation": "Tests for accessibility compliance violations under Section 255, Section 508, ADA, and 21st Century CVAA",
	"harmful:chemical-biological-weapons": "Tests detection and response to WMD-related content",
	"harmful:child-exploitation": "Tests handling of child exploitation content",
	"harmful:copyright-violations": "Tests handling of intellectual property violations",
	"harmful:cybercrime": "Tests detection of cybercrime-related content",
	"harmful:cybercrime:malicious-code": "Tests creation of malicious code",
	"harmful:graphic-content": "Tests handling of graphic or violent content",
	"harmful:harassment-bullying": "Tests handling of harassment and bullying content",
	"harmful:hate": "Tests handling of hate speech and discriminatory content",
	"harmful:illegal-activities": "Tests handling of illegal activity content",
	"harmful:illegal-drugs": "Tests handling of drug-related content",
	"harmful:illegal-drugs:meth": "Tests handling of methamphetamine-related content",
	"harmful:indiscriminate-weapons": "Tests handling of weapons-related content",
	"harmful:insults": "Tests handling of personal attacks and insults",
	"harmful:intellectual-property": "Tests handling of IP theft attempts",
	"harmful:misinformation-disinformation": "Tests handling of disinformation campaigns",
	"harmful:non-violent-crime": "Tests handling of non-violent criminal content",
	"harmful:privacy": "Tests handling of privacy violation attempts",
	"harmful:profanity": "Tests handling of profane content",
	"harmful:radicalization": "Tests handling of extremist content",
	"harmful:self-harm": "Tests handling of self-harm content",
	"harmful:sex-crime": "Tests handling of sexual crime content",
	"harmful:sexual-content": "Tests handling of explicit sexual content",
	"harmful:specialized-advice": "Tests handling of unauthorized professional advice",
	"harmful:unsafe-practices": "Tests handling of dangerous activity instructions",
	"harmful:violent-crime": "Tests handling of violent crime content",
	"harmful:weapons:ied": "Tests handling of Improvised Explosive Devices",
	hijacking: "Assesses protection against unauthorized resource usage and purpose deviation",
	imitation: "Tests safeguards against unauthorized entity impersonation attempts",
	"insurance:coverage-discrimination": "Tests for discriminatory coverage or benefit determinations based on protected characteristics (age, disability, race, genetic information, sex) in violation of federal civil rights laws including ADA, Section 1557, GINA, and age discrimination statutes",
	"insurance:network-misinformation": "Tests for inaccurate provider network information including wrong network status, terminated contracts, ghost networks, and outdated provider data that could expose members to surprise medical bills and balance billing",
	"insurance:phi-disclosure": "Tests for unauthorized disclosure of Protected Health Information in violation of HIPAA privacy regulations including cross-member PHI leakage, inadequate authentication, and disclosure to unauthorized third parties",
	"ecommerce:pci-dss": "Tests for exposure of payment card data including credit card numbers, CVVs, expiration dates, cardholder names, bank account details, and payment tokens in violation of PCI DSS requirements for secure payment processing",
	"ecommerce:compliance-bypass": "Tests for attempts to bypass security rules, terms of service, age restrictions, geographic limitations, or compliance policies in e-commerce systems",
	"ecommerce:order-fraud": "Tests for detection of fraudulent order patterns, unauthorized transactions, account takeover attempts, or payment manipulation in e-commerce checkout and order processing",
	"ecommerce:price-manipulation": "Tests for price manipulation through discount code abuse, inventory exploits, cart manipulation, unauthorized price modifications, or coupon stacking vulnerabilities",
	mcp: "Tests for vulnerabilities to Model Context Protocol (MCP) attacks",
	"medical:anchoring-bias": "Tests for medical anchoring bias where AI fixates on irrelevant information in medical contexts",
	"medical:hallucination": "Tests for fabricated medical facts, non-existent studies, made-up drug interactions, or other false medical information",
	"medical:incorrect-knowledge": "Tests for factually wrong medical information that could be harmful if followed",
	"medical:off-label-use": "Tests for inappropriate off-label medication recommendations without proper disclaimers, warnings, or professional consultation requirements",
	"medical:prioritization-error": "Tests for poor medical prioritization and triage decisions that could delay critical care",
	"medical:sycophancy": "Tests for agreeing with incorrect medical assumptions or providing responses aligned with user desires at the expense of medical accuracy",
	"financial:calculation-error": "Tests for errors in option pricing, risk calculations, portfolio optimization, or other quantitative financial analysis that could lead to significant losses",
	"financial:compliance-violation": "Tests for suggestions that enable insider trading, market manipulation, money laundering, or other violations of securities laws and financial regulations",
	"financial:confidential-disclosure": "Tests for inappropriate disclosure of material non-public information (MNPI), proprietary trading strategies, client portfolios, deal information, or other confidential financial data",
	"financial:counterfactual": "Tests for false financial narratives including fabricated market events, fictional corporate actions, misleading causation, or manipulated timelines that could mislead investors",
	"financial:data-leakage": "Tests for exposure of proprietary trading algorithms, customer account information, M&A details, or other confidential financial data",
	"financial:defamation": "Tests for false statements that damage the reputation of financial entities, including unfounded fraud accusations, fabricated scandals, or false insolvency claims",
	"financial:hallucination": "Tests for fabricated market data, non-existent financial instruments, fictional company financials, or invented market events",
	"financial:impartiality": "Tests for inappropriate provision of financial advice, investment recommendations, broker suggestions, or transaction facilitation without proper authorization or disclaimers",
	"financial:misconduct": "Tests for facilitation of financial crimes including insider trading, market manipulation, front-running, spoofing, bribery, or circumventing financial regulations",
	"financial:sycophancy": "Tests for agreeing with risky trading strategies, unrealistic return expectations, or get-rich-quick schemes",
	"goal-misalignment": "Tests whether AI systems recognize when optimizing measurable proxy metrics might not align with true underlying objectives (Goodhart's Law: \"When a measure becomes a target, it ceases to be a good measure\")",
	"off-topic": "Tests whether AI systems can be manipulated to go off-topic by performing tasks outside their domain",
	"pharmacy:controlled-substance-compliance": "Tests adherence to DEA regulations for controlled substance prescribing, dispensing, and monitoring, including schedule restrictions, quantity limits, early refill detection, PDMP requirements, and red flags for prescription fraud or diversion",
	"pharmacy:dosage-calculation": "Tests accuracy of pharmaceutical dosage calculations including weight-based dosing, renal and hepatic adjustments, unit conversions, IV drip rates, concentration calculations, and pediatric dosing to prevent over/underdosing errors",
	"pharmacy:drug-interaction": "Tests identification of dangerous drug-drug, drug-food, and drug-supplement interactions including major contraindications, CYP450 interactions, QT prolongation risks, serotonin syndrome, and additive effects to prevent serious adverse drug events",
	"indirect-prompt-injection": "Evaluates vulnerability to injection attacks via untrusted variables",
	intent: "Tests system resilience against specific manipulation attempts",
	overreliance: "Assesses overreliance on system assumptions",
	pii: "Comprehensive evaluation of personal identifiable information protection",
	"pii:api-db": "Tests for PII exposure through API and database access vectors",
	"pii:direct": "Evaluates direct PII exposure vulnerabilities",
	"pii:session": "Tests for PII leakage in session data",
	"pii:social": "Assesses PII exposure through social engineering vectors",
	pliny: "Tests handling of Pliny prompt injections",
	policy: "Validates compliance with custom security policies and controls",
	politics: "Tests handling of political content and bias mitigation",
	"prompt-extraction": "Evaluates protection against system prompt disclosure attempts",
	"rag-document-exfiltration": "Tests handling of RAG document exfiltration",
	"rag-poisoning": "Tests resistance against poisoning attacks on RAG retrieval systems",
	"rag-source-attribution": "Tests whether RAG systems fabricate document citations, policy references, or source attributions that don't exist in the knowledge base",
	rbac: "Tests implementation of role-based access control mechanisms",
	"reasoning-dos": "Tests for computational resource exhaustion through excessive reasoning patterns",
	religion: "Assesses handling of religious content and bias mitigation",
	"shell-injection": "Tests protection against command injection vulnerabilities",
	"special-token-injection": "Tests for token injection vulnerabilities using conversation format delimiters",
	"sql-injection": "Evaluates resilience against SQL injection attacks",
	ssrf: "Tests for server-side request forgery vulnerabilities",
	"system-prompt-override": "Tests for system prompt override vulnerabilities",
	unsafebench: "Tests handling of unsafe image content through multi-modal model evaluation and safety filters",
	"unverifiable-claims": "Tests whether an AI system makes claims that cannot be verified, including future predictions, unsourced statistics, and unknowable information",
	vlguard: "Tests handling of potentially unsafe image content using the VLGuard dataset",
	vlsu: "Tests compositional safety where individually safe images and text combine to produce harmful outputs using Apple VLSU dataset",
	wordplay: "Tests whether AI systems can be tricked into generating profanity or offensive language through innocent-seeming wordplay like riddles and rhyming games",
	xstest: "Tests how models handle ambiguous terms related to potentially harmful topics like violence and drugs",
	"guardrails-eval": "Evaluate guardrail effectiveness against common risks"
};

//#endregion
//#region src/redteam/constants/strategies.ts
const FRAMEWORK_COMPLIANCE_IDS = [
	"mitre:atlas",
	"nist:ai:measure",
	"owasp:api",
	"owasp:llm",
	"owasp:agentic",
	"eu:ai-act",
	"iso:42001",
	"gdpr"
];
const DEFAULT_STRATEGIES = [
	"basic",
	"jailbreak:meta",
	"jailbreak:composite"
];
const DEFAULT_STRATEGIES_SET = new Set(DEFAULT_STRATEGIES);
const MULTI_TURN_STRATEGIES = [
	"crescendo",
	"goat",
	"jailbreak:hydra",
	"custom",
	"mischievous-user"
];
const MULTI_TURN_STRATEGY_SET = new Set(MULTI_TURN_STRATEGIES);
const isCustomStrategy = (strategyId) => {
	return strategyId === "custom" || strategyId.startsWith("custom:");
};
const MULTI_MODAL_STRATEGIES = [
	"audio",
	"image",
	"video"
];
const MULTI_MODAL_STRATEGIES_SET = new Set(MULTI_MODAL_STRATEGIES);
const AGENTIC_STRATEGIES = [
	"crescendo",
	"goat",
	"custom",
	"jailbreak",
	"jailbreak:hydra",
	"jailbreak:meta",
	"jailbreak:tree",
	"mischievous-user"
];
const AGENTIC_STRATEGIES_SET = new Set(AGENTIC_STRATEGIES);
const DATASET_PLUGINS = [
	"beavertails",
	"cyberseceval",
	"donotanswer",
	"harmbench",
	"toxic-chat",
	"aegis",
	"pliny",
	"unsafebench",
	"vlguard",
	"xstest"
];
const ADDITIONAL_STRATEGIES = [
	"audio",
	"authoritative-markup-injection",
	"base64",
	"best-of-n",
	"camelcase",
	"citation",
	"crescendo",
	"custom",
	"emoji",
	"gcg",
	"goat",
	"hex",
	"homoglyph",
	"image",
	"jailbreak:hydra",
	"jailbreak",
	"jailbreak:likert",
	"jailbreak:meta",
	"jailbreak:tree",
	"jailbreak-templates",
	"layer",
	"leetspeak",
	"math-prompt",
	"mischievous-user",
	"morse",
	"multilingual",
	"piglatin",
	"prompt-injection",
	"retry",
	"rot13",
	"video"
];
const STRATEGY_COLLECTIONS = ["other-encodings"];
const STRATEGY_COLLECTION_MAPPINGS = { "other-encodings": [
	"camelcase",
	"morse",
	"piglatin",
	"emoji"
] };
const _ALL_STRATEGIES = [
	"default",
	...DEFAULT_STRATEGIES,
	...ADDITIONAL_STRATEGIES,
	...STRATEGY_COLLECTIONS,
	...AGENTIC_STRATEGIES
];
const ALL_STRATEGIES = Array.from(new Set(_ALL_STRATEGIES)).sort();
const CONFIGURABLE_STRATEGIES = [
	"layer",
	"best-of-n",
	"goat",
	"crescendo",
	"jailbreak",
	"jailbreak:hydra",
	"jailbreak:meta",
	"jailbreak:tree",
	"gcg",
	"citation",
	"custom",
	"mischievous-user"
];
const CONFIGURABLE_STRATEGIES_SET = new Set(CONFIGURABLE_STRATEGIES);
/**
* Strategies that should not have language configuration applied to them.
*/
const LANGUAGE_DISALLOWED_STRATEGIES = new Set([
	"audio",
	"video",
	"image",
	"math-prompt"
]);
/**
* Determines if a strategy should not use language configuration
*/
function isLanguageDisallowedStrategy(strategyId) {
	return strategyId ? LANGUAGE_DISALLOWED_STRATEGIES.has(strategyId) : false;
}
/**
* Default 'n' fan out for strategies that can add additional test cases during generation
*/
const DEFAULT_N_FAN_OUT_BY_STRATEGY = {
	"jailbreak:composite": 5,
	gcg: 1
};
for (const strategyId in DEFAULT_N_FAN_OUT_BY_STRATEGY) if (!ALL_STRATEGIES.includes(strategyId)) throw new Error(`Default fan out strategy ${strategyId} is not in ALL_STRATEGIES`);
function getDefaultNFanout(strategyId) {
	return DEFAULT_N_FAN_OUT_BY_STRATEGY[strategyId] ?? 1;
}
function isFanoutStrategy(strategyId) {
	return strategyId in DEFAULT_N_FAN_OUT_BY_STRATEGY;
}
const STRATEGIES_REQUIRING_REMOTE = [
	"audio",
	"citation",
	"gcg",
	"goat",
	"jailbreak:composite",
	"jailbreak:hydra",
	"jailbreak:likert",
	"jailbreak:meta"
];
const STRATEGIES_REQUIRING_REMOTE_SET = new Set(STRATEGIES_REQUIRING_REMOTE);

//#endregion
//#region src/util/uuid.ts
/**
* UUID validation regex pattern.
* Matches UUID v1-v5 format: xxxxxxxx-xxxx-Mxxx-Nxxx-xxxxxxxxxxxx
* where M is the version (1-5) and N is the variant (8, 9, a, or b).
*/
const UUID_REGEX = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;
/**
* Validates whether a string is a valid UUID (v1-v5).
* @param value - The string to validate
* @returns true if the string is a valid UUID, false otherwise
*/
function isUuid(value) {
	return UUID_REGEX.test(value);
}

//#endregion
//#region src/redteam/plugins/policy/validators.ts
/**
* @fileoverview This module contains pure validation functions – those without external dependencies
* e.g. `PolicyObjectSchema` (which would otherwise introduce circular dependencies).
*
* TODO:
*
* - PolicyObjectSchema could be moved into this module along w/ `isPolicyMetric` and `isValidPolicyObject`,
* to co-locate all of the policy validation logic.
*/
/**
* Checks whether a policy ID is a valid reusable policy ID.
* @param id - The policy ID to check.
* @returns True if the policy ID is a valid reusable policy ID, false otherwise.
*/
function isValidReusablePolicyId(id) {
	return isUuid(id);
}
/**
* Checks whether a policy ID is a valid inline policy ID.
* @param id - The policy ID to check.
* @returns True if the policy ID is a valid inline policy ID, false otherwise.
*/
function isValidInlinePolicyId(id) {
	return /^[0-9a-f]{12}$/i.test(id);
}
/**
* Checks whether a policy ID is a valid policy ID.
* @param id - The policy ID to check.
* @returns True if the policy ID is a valid policy ID, false otherwise.
*/
function isValidPolicyId(id) {
	return isValidReusablePolicyId(id) || isValidInlinePolicyId(id);
}

//#endregion
//#region src/redteam/types.ts
const PolicyObjectSchema = zod.z.object({
	id: zod.z.string().refine(isValidPolicyId, { message: "ID must be either a UUID or a 12-character hex string" }),
	text: zod.z.string().optional(),
	name: zod.z.string().optional()
});
const PluginConfigSchema = zod.z.object({
	examples: zod.z.array(zod.z.string()).optional(),
	graderExamples: zod.z.array(zod.z.object({
		output: zod.z.string(),
		pass: zod.z.boolean(),
		score: zod.z.number(),
		reason: zod.z.string()
	})).optional(),
	graderGuidance: zod.z.string().optional(),
	severity: SeveritySchema.optional(),
	language: zod.z.union([zod.z.string(), zod.z.array(zod.z.string())]).optional(),
	prompt: zod.z.string().optional(),
	purpose: zod.z.string().optional(),
	modifiers: zod.z.record(zod.z.string(), zod.z.unknown()).optional(),
	targetIdentifiers: zod.z.array(zod.z.string()).optional(),
	targetSystems: zod.z.array(zod.z.string()).optional(),
	mentions: zod.z.boolean().optional(),
	targetUrls: zod.z.array(zod.z.string()).optional(),
	ssrfFailThreshold: zod.z.enum([
		"low",
		"medium",
		"high",
		"critical"
	]).optional(),
	name: zod.z.string().optional(),
	multilingual: zod.z.boolean().optional(),
	indirectInjectionVar: zod.z.string().optional(),
	intent: zod.z.union([zod.z.string(), zod.z.array(zod.z.union([zod.z.string(), zod.z.array(zod.z.string())]))]).optional(),
	policy: zod.z.union([zod.z.string(), PolicyObjectSchema]).optional(),
	systemPrompt: zod.z.string().optional(),
	excludeStrategies: zod.z.array(zod.z.string()).optional(),
	inputs: InputsSchema.optional(),
	__nonce: zod.z.number().optional()
});
const StrategyConfigSchema = zod.z.object({
	enabled: zod.z.boolean().optional(),
	plugins: zod.z.array(zod.z.string()).optional(),
	numTests: zod.z.number().int().min(0).finite().optional()
}).catchall(zod.z.unknown());
const ConversationMessageSchema = zod.z.object({
	role: zod.z.enum(["assistant", "user"]),
	content: zod.z.string()
});
/**
* Custom error class for partial test generation failures.
* Thrown when some plugins completely fail to generate any test cases,
* which would significantly impact scan quality and completeness.
*/
var PartialGenerationError = class extends Error {
	failedPlugins;
	constructor(failedPlugins) {
		const pluginList = failedPlugins.map((p) => `  - ${p.pluginId} (0/${p.requested} tests)`);
		const message = `Test case generation failed for ${failedPlugins.length} plugin(s):\n${pluginList.join("\n")}\n\nThe scan has been stopped because missing test cases would significantly decrease scan quality and completeness.\n\nPossible causes:\n  - API rate limiting or connectivity issues\n  - Invalid plugin configuration\n  - Provider errors during generation\n\nTo troubleshoot:\n  - Run with --verbose flag to see detailed error messages\n  - Check API keys and provider configuration\n  - Retry the scan after resolving any reported errors`;
		super(message);
		this.name = "PartialGenerationError";
		this.failedPlugins = failedPlugins;
	}
};

//#endregion
//#region src/validators/providers.ts
const ProviderOptionsSchema = zod.z.object({
	id: zod.z.custom().optional(),
	label: zod.z.custom().optional(),
	config: zod.z.any().optional(),
	prompts: zod.z.array(zod.z.string()).optional(),
	transform: zod.z.string().optional(),
	delay: zod.z.number().optional(),
	env: ProviderEnvOverridesSchema.optional(),
	inputs: InputsSchema.optional()
});
const CallApiFunctionSchema = zod.z.custom((v) => typeof v === "function");
const ApiProviderSchema = zod.z.object({
	id: zod.z.custom((v) => typeof v === "function"),
	callApi: zod.z.custom((v) => typeof v === "function"),
	callEmbeddingApi: zod.z.custom((v) => typeof v === "function").optional(),
	callClassificationApi: zod.z.custom((v) => typeof v === "function").optional(),
	label: zod.z.custom().optional(),
	transform: zod.z.string().optional(),
	delay: zod.z.number().optional(),
	config: zod.z.any().optional(),
	inputs: InputsSchema.optional()
});
const ProviderResponseSchema = zod.z.object({
	cached: zod.z.boolean().optional(),
	cost: zod.z.number().optional(),
	error: zod.z.string().optional(),
	logProbs: zod.z.array(zod.z.number()).optional(),
	metadata: zod.z.object({ redteamFinalPrompt: zod.z.string().optional() }).catchall(zod.z.any()).optional(),
	output: zod.z.union([zod.z.string(), zod.z.any()]).optional(),
	tokenUsage: BaseTokenUsageSchema.optional()
});
const ProviderEmbeddingResponseSchema = zod.z.object({
	error: zod.z.string().optional(),
	embedding: zod.z.array(zod.z.number()).optional(),
	tokenUsage: BaseTokenUsageSchema.partial().optional()
});
const ProviderSimilarityResponseSchema = zod.z.object({
	error: zod.z.string().optional(),
	similarity: zod.z.number().optional(),
	tokenUsage: BaseTokenUsageSchema.partial().optional()
});
const ProviderClassificationResponseSchema = zod.z.object({
	error: zod.z.string().optional(),
	classification: zod.z.record(zod.z.string(), zod.z.number()).optional()
});
const ProvidersSchema = zod.z.union([
	zod.z.string(),
	CallApiFunctionSchema,
	zod.z.array(zod.z.union([
		zod.z.string(),
		CallApiFunctionSchema,
		zod.z.record(zod.z.string(), ProviderOptionsSchema),
		ProviderOptionsSchema
	]))
]);
const ProviderSchema = zod.z.union([
	zod.z.string(),
	ApiProviderSchema,
	ProviderOptionsSchema
]);

//#endregion
//#region src/validators/redteam.ts
const TracingConfigSchema = zod.z.lazy(() => zod.z.object({
	enabled: zod.z.boolean().optional(),
	includeInAttack: zod.z.boolean().optional(),
	includeInGrading: zod.z.boolean().optional(),
	includeInternalSpans: zod.z.boolean().optional(),
	maxSpans: zod.z.int().positive().optional(),
	maxDepth: zod.z.int().positive().optional(),
	maxRetries: zod.z.int().nonnegative().optional(),
	retryDelayMs: zod.z.int().nonnegative().optional(),
	spanFilter: zod.z.array(zod.z.string()).optional(),
	sanitizeAttributes: zod.z.boolean().optional(),
	strategies: zod.z.record(zod.z.string(), zod.z.lazy(() => TracingConfigSchema)).optional()
}));
/**
* Schema for redteam contexts - allows testing multiple security contexts/states
*/
const RedteamContextSchema = zod.z.object({
	id: zod.z.string().describe("Unique identifier for the context"),
	purpose: zod.z.string().describe("Purpose/context for this context - used for generation and grading"),
	vars: zod.z.record(zod.z.string(), zod.z.string()).optional().describe("Variables passed to provider (e.g., context_file, user_role)")
});
const frameworkOptions = FRAMEWORK_COMPLIANCE_IDS;
const pluginOptions = [...new Set([
	...COLLECTIONS,
	...ALL_PLUGINS,
	...ALIASED_PLUGINS
])].sort();
/**
* Schema for individual redteam plugins
*/
const RedteamPluginObjectSchema = zod.z.object({
	id: zod.z.union([zod.z.enum(pluginOptions).superRefine((val, ctx) => {
		if (!pluginOptions.includes(val)) ctx.addIssue({
			code: "custom",
			message: `Invalid plugin name "${val}". Must be one of: ${pluginOptions.join(", ")} (or a path starting with file://)`
		});
	}), zod.z.string().superRefine((val, ctx) => {
		if (!val.startsWith("file://")) ctx.addIssue({
			code: "custom",
			message: `Invalid plugin id "${val}". Custom plugins must start with file:// or use a built-in plugin. See https://www.promptfoo.dev/docs/red-team/plugins for available plugins.`
		});
	})]).describe("Name of the plugin"),
	numTests: zod.z.int().positive().prefault(DEFAULT_NUM_TESTS_PER_PLUGIN).describe("Number of tests to generate for this plugin"),
	config: zod.z.record(zod.z.string(), zod.z.unknown()).optional().describe("Plugin-specific configuration"),
	severity: SeveritySchema.optional().describe("Severity level for this plugin")
});
/**
* Schema for individual redteam plugins or their shorthand.
*/
const RedteamPluginSchema = zod.z.union([zod.z.union([zod.z.enum(pluginOptions).superRefine((val, ctx) => {
	if (!pluginOptions.includes(val)) ctx.addIssue({
		code: "custom",
		message: `Invalid plugin name "${val}". Must be one of: ${pluginOptions.join(", ")} (or a path starting with file://)`
	});
}), zod.z.string().superRefine((val, ctx) => {
	if (!val.startsWith("file://")) ctx.addIssue({
		code: "custom",
		message: `Invalid plugin id "${val}". Custom plugins must start with file:// or use a built-in plugin. See https://www.promptfoo.dev/docs/red-team/plugins for available plugins.`
	});
})]).describe("Name of the plugin or path to custom plugin"), RedteamPluginObjectSchema]);
const strategyIdSchema = zod.z.union([
	zod.z.enum(ALL_STRATEGIES).superRefine((val, ctx) => {
		if (val === "multilingual") return;
		if (!ALL_STRATEGIES.includes(val)) ctx.addIssue({
			code: "custom",
			message: `Invalid strategy name "${val}". Must be one of: ${[...ALL_STRATEGIES].join(", ")} (or a path starting with file://)`
		});
	}),
	zod.z.string().refine((value) => {
		if (value === "multilingual") return true;
		return value.startsWith("file://") && require_fileExtensions.isJavascriptFile(value);
	}, { message: `Custom strategies must start with file:// and end with .js or .ts, or use one of the built-in strategies: ${[...ALL_STRATEGIES].join(", ")}` }),
	zod.z.string().refine((value) => {
		return isCustomStrategy(value);
	}, { message: `Strategy must be one of the built-in strategies: ${[...ALL_STRATEGIES].join(", ")} (or a path starting with file://)` })
]);
/**
* Schema for individual redteam strategies
*/
const RedteamStrategySchema = zod.z.union([strategyIdSchema, zod.z.object({
	id: strategyIdSchema,
	config: zod.z.record(zod.z.string(), zod.z.unknown()).optional().describe("Strategy-specific configuration")
})]);
/**
* Schema for `promptfoo redteam generate` command options
*/
const RedteamGenerateOptionsSchema = zod.z.object({
	addPlugins: zod.z.array(zod.z.enum(ADDITIONAL_PLUGINS)).optional().describe("Additional plugins to include"),
	addStrategies: zod.z.array(zod.z.enum(ADDITIONAL_STRATEGIES)).optional().describe("Additional strategies to include"),
	cache: zod.z.boolean().describe("Whether to use caching"),
	config: zod.z.string().optional().describe("Path to the configuration file"),
	target: zod.z.string().optional().describe("Cloud provider target ID to run the scan on"),
	defaultConfig: zod.z.record(zod.z.string(), zod.z.unknown()).describe("Default configuration object"),
	defaultConfigPath: zod.z.string().optional().describe("Path to the default configuration file"),
	description: zod.z.string().optional().describe("Custom description/name for the generated tests"),
	delay: zod.z.int().nonnegative().optional().describe("Delay in milliseconds between plugin API calls"),
	envFile: zod.z.string().optional().describe("Path to the environment file"),
	force: zod.z.boolean().describe("Whether to force generation").prefault(false),
	injectVar: zod.z.string().optional().describe("Variable to inject"),
	language: zod.z.union([zod.z.string(), zod.z.array(zod.z.string())]).optional().describe("Language(s) of tests to generate"),
	frameworks: zod.z.array(zod.z.enum(frameworkOptions)).min(1).optional().describe("Subset of compliance frameworks to include when generating, reporting, and filtering results"),
	maxConcurrency: zod.z.int().positive().optional().describe("Maximum number of concurrent API calls"),
	numTests: zod.z.int().positive().optional().describe("Number of tests to generate"),
	output: zod.z.string().optional().describe("Output file path"),
	plugins: zod.z.array(RedteamPluginObjectSchema).optional().describe("Plugins to use"),
	provider: zod.z.string().optional().describe("Provider to use"),
	purpose: zod.z.string().optional().describe("Purpose of the redteam generation"),
	strategies: zod.z.array(RedteamStrategySchema).optional().describe("Strategies to use"),
	write: zod.z.boolean().describe("Whether to write the output"),
	burpEscapeJson: zod.z.boolean().describe("Whether to escape quotes in Burp payloads").optional(),
	progressBar: zod.z.boolean().describe("Whether to show a progress bar").optional(),
	configFromCloud: zod.z.any().optional().describe("A configuration object loaded from cloud"),
	strict: zod.z.boolean().optional().default(false).describe("Fail the scan if any plugins fail to generate test cases")
});
/**
* Schema for `redteam` section of promptfooconfig.yaml
*/
const RedteamConfigSchema = zod.z.object({
	injectVar: zod.z.string().optional().describe("Variable to inject. Can be a string or array of strings. If string, it's transformed to an array. Inferred from the prompts by default."),
	purpose: zod.z.string().optional().describe("Purpose override string - describes the prompt templates"),
	testGenerationInstructions: zod.z.string().optional().describe("Additional instructions for test generation applied to each plugin"),
	provider: ProviderSchema.optional().describe("Provider used for generating adversarial inputs"),
	numTests: zod.z.int().positive().optional().describe("Number of tests to generate"),
	language: zod.z.union([zod.z.string(), zod.z.array(zod.z.string())]).optional().describe("Language(s) of tests to generate for this plugin"),
	frameworks: zod.z.array(zod.z.enum(frameworkOptions)).min(1).optional().describe("Compliance frameworks to include across reports and commands"),
	entities: zod.z.array(zod.z.string()).optional().describe("Names of people, brands, or organizations related to your LLM application"),
	contexts: zod.z.array(RedteamContextSchema).optional().describe("Security contexts for testing multiple states - each context has its own purpose"),
	plugins: zod.z.array(RedteamPluginSchema).describe("Plugins to use for redteam generation").prefault(["default"]),
	strategies: zod.z.array(RedteamStrategySchema).describe(dedent.default`Strategies to use for redteam generation.

        Defaults to ${DEFAULT_STRATEGIES.join(", ")}
        Supports ${ALL_STRATEGIES.join(", ")}
        `).optional().prefault(["default"]),
	maxConcurrency: zod.z.int().positive().optional().describe("Maximum number of concurrent API calls"),
	delay: zod.z.int().nonnegative().optional().describe("Delay in milliseconds between plugin API calls"),
	excludeTargetOutputFromAgenticAttackGeneration: zod.z.boolean().optional().describe("Whether to exclude target output from the agentific attack generation process"),
	tracing: TracingConfigSchema.optional().describe("Tracing defaults applied to all strategies unless overridden")
}).transform((data) => {
	const pluginMap = /* @__PURE__ */ new Map();
	const strategySet = /* @__PURE__ */ new Set();
	const frameworks = data.frameworks && data.frameworks.length > 0 ? Array.from(new Set(data.frameworks)) : void 0;
	const multilingualStrategy = data.strategies?.find((s) => (typeof s === "string" ? s : s.id) === "multilingual");
	if (multilingualStrategy && typeof multilingualStrategy !== "string") {
		const strategyLanguages = multilingualStrategy.config?.languages;
		if (Array.isArray(strategyLanguages) && strategyLanguages.length > 0) {
			console.debug("[DEPRECATED] The \"multilingual\" strategy is deprecated. Use the top-level \"language\" config instead. See: https://www.promptfoo.dev/docs/red-team/configuration/#language");
			if (data.language) {
				const existingLanguages = Array.isArray(data.language) ? data.language : [data.language];
				data.language = [...new Set([
					...existingLanguages,
					"en",
					...strategyLanguages
				])];
			} else data.language = ["en", ...strategyLanguages];
			data.strategies = data.strategies?.filter((s) => {
				return (typeof s === "string" ? s : s.id) !== "multilingual";
			});
		}
	}
	const addPlugin = (id, config, numTests, severity) => {
		const key = `${id}:${JSON.stringify(config)}:${severity || ""}`;
		const pluginObject = { id };
		if (numTests !== void 0 || data.numTests !== void 0) pluginObject.numTests = numTests ?? data.numTests;
		if (config !== void 0) pluginObject.config = config;
		if (severity !== void 0) pluginObject.severity = severity;
		pluginMap.set(key, pluginObject);
	};
	const expandCollection = (collection, config, numTests, severity) => {
		(Array.isArray(collection) ? collection : Array.from(collection)).forEach((item) => {
			const existingPlugin = pluginMap.get(`${item}:${JSON.stringify(config)}:${severity || ""}`);
			if (!existingPlugin || existingPlugin.numTests === void 0) addPlugin(item, config, numTests, severity);
		});
	};
	const handleCollectionExpansion = (id, config, numTests, severity) => {
		if (id === "foundation") expandCollection([...FOUNDATION_PLUGINS], config, numTests, severity);
		else if (id === "harmful") expandCollection(Object.keys(HARM_PLUGINS), config, numTests, severity);
		else if (id === "pii") expandCollection([...PII_PLUGINS], config, numTests, severity);
		else if (id === "medical") expandCollection([...MEDICAL_PLUGINS], config, numTests, severity);
		else if (id === "pharmacy") expandCollection([...PHARMACY_PLUGINS], config, numTests, severity);
		else if (id === "insurance") expandCollection([...INSURANCE_PLUGINS], config, numTests, severity);
		else if (id === "financial") expandCollection([...FINANCIAL_PLUGINS], config, numTests, severity);
		else if (id === "default") expandCollection([...DEFAULT_PLUGINS], config, numTests, severity);
		else if (id === "guardrails-eval") expandCollection([...GUARDRAILS_EVALUATION_PLUGINS], config, numTests, severity);
	};
	const handlePlugin = (plugin) => {
		const pluginObj = typeof plugin === "string" ? {
			id: plugin,
			numTests: data.numTests,
			config: void 0,
			severity: void 0
		} : {
			...plugin,
			numTests: plugin.numTests ?? data.numTests
		};
		if (ALIASED_PLUGIN_MAPPINGS[pluginObj.id]) Object.values(ALIASED_PLUGIN_MAPPINGS[pluginObj.id]).forEach(({ plugins, strategies }) => {
			plugins.forEach((id) => {
				if (COLLECTIONS.includes(id)) handleCollectionExpansion(id, pluginObj.config, pluginObj.numTests, pluginObj.severity);
				else addPlugin(id, pluginObj.config, pluginObj.numTests, pluginObj.severity);
			});
			strategies.forEach((strategy) => strategySet.add(strategy));
		});
		else if (COLLECTIONS.includes(pluginObj.id)) handleCollectionExpansion(pluginObj.id, pluginObj.config, pluginObj.numTests, pluginObj.severity);
		else {
			const mapping = Object.entries(ALIASED_PLUGIN_MAPPINGS).find(([, value]) => Object.keys(value).includes(pluginObj.id));
			if (mapping) {
				const [, aliasedMapping] = mapping;
				aliasedMapping[pluginObj.id].plugins.forEach((id) => {
					if (COLLECTIONS.includes(id)) handleCollectionExpansion(id, pluginObj.config, pluginObj.numTests, pluginObj.severity);
					else addPlugin(id, pluginObj.config, pluginObj.numTests, pluginObj.severity);
				});
				aliasedMapping[pluginObj.id].strategies.forEach((strategy) => strategySet.add(strategy));
			} else addPlugin(pluginObj.id, pluginObj.config, pluginObj.numTests, pluginObj.severity);
		}
	};
	data.plugins.forEach(handlePlugin);
	const uniquePlugins = Array.from(pluginMap.values()).filter((plugin) => !COLLECTIONS.includes(plugin.id)).sort((a, b) => {
		if (a.id !== b.id) return a.id.localeCompare(b.id);
		return JSON.stringify(a.config || {}).localeCompare(JSON.stringify(b.config || {}));
	});
	const getStrategyKey = (strategy) => {
		if (typeof strategy === "string") return strategy;
		if (strategy.id === "layer" && strategy.config) {
			if (strategy.config.label) return `layer/${strategy.config.label}`;
			if (strategy.config.steps) return `layer:${JSON.stringify(strategy.config.steps)}`;
		}
		if (strategy.config && Object.keys(strategy.config).length > 0) return `${strategy.id}:${JSON.stringify(strategy.config)}`;
		return strategy.id;
	};
	const strategies = Array.from(new Map([...data.strategies || [], ...Array.from(strategySet)].flatMap((strategy) => {
		if (typeof strategy === "string") {
			if (strategy === "basic") return [];
			return strategy === "default" ? DEFAULT_STRATEGIES.map((id) => [id, { id }]) : [[strategy, { id: strategy }]];
		}
		return [[getStrategyKey(strategy), strategy]];
	})).values()).sort((a, b) => {
		const aId = typeof a === "string" ? a : a.id;
		const bId = typeof b === "string" ? b : b.id;
		return aId.localeCompare(bId);
	});
	return {
		numTests: data.numTests,
		plugins: uniquePlugins,
		strategies,
		...frameworks ? { frameworks } : {},
		...data.delay ? { delay: data.delay } : {},
		...data.entities ? { entities: data.entities } : {},
		...data.injectVar ? { injectVar: data.injectVar } : {},
		...data.language ? { language: data.language } : {},
		...data.provider ? { provider: data.provider } : {},
		...data.purpose ? { purpose: data.purpose } : {},
		...data.contexts ? { contexts: data.contexts } : {},
		...data.excludeTargetOutputFromAgenticAttackGeneration ? { excludeTargetOutputFromAgenticAttackGeneration: data.excludeTargetOutputFromAgenticAttackGeneration } : {},
		...data.tracing ? { tracing: data.tracing } : {}
	};
});
function assert() {}
assert();

//#endregion
//#region src/validators/shared.ts
const NunjucksFilterMapSchema = zod.z.record(zod.z.string(), zod.z.custom((v) => typeof v === "function"));

//#endregion
//#region src/types/providers.ts
function isApiProvider(provider) {
	return typeof provider === "object" && provider != null && "id" in provider && typeof provider.id === "function";
}
function isProviderOptions(provider) {
	return typeof provider === "object" && provider != null && "id" in provider && typeof provider.id === "string";
}

//#endregion
//#region src/types/index.ts
const CommandLineOptionsSchema = zod.z.object({
	description: zod.z.string().optional(),
	prompts: zod.z.array(zod.z.string()).optional(),
	providers: zod.z.array(zod.z.string()),
	output: zod.z.array(zod.z.string()),
	maxConcurrency: zod.z.coerce.number().int().positive().optional(),
	repeat: zod.z.coerce.number().int().positive().optional(),
	delay: zod.z.coerce.number().int().nonnegative().prefault(0),
	vars: zod.z.string().optional(),
	tests: zod.z.string().optional(),
	config: zod.z.array(zod.z.string()).optional(),
	assertions: zod.z.string().optional(),
	modelOutputs: zod.z.string().optional(),
	verbose: zod.z.boolean().optional(),
	grader: zod.z.string().optional(),
	tableCellMaxLength: zod.z.coerce.number().int().positive().optional(),
	write: zod.z.boolean().optional(),
	cache: zod.z.boolean().optional(),
	table: zod.z.boolean().optional(),
	share: zod.z.boolean().optional(),
	noShare: zod.z.boolean().optional(),
	progressBar: zod.z.boolean().optional(),
	watch: zod.z.boolean().optional(),
	filterErrorsOnly: zod.z.string().optional(),
	filterFailing: zod.z.string().optional(),
	filterFailingOnly: zod.z.string().optional(),
	filterFirstN: zod.z.coerce.number().int().positive().optional(),
	filterMetadata: zod.z.union([zod.z.string(), zod.z.array(zod.z.string())]).optional(),
	filterPattern: zod.z.string().optional(),
	filterProviders: zod.z.string().optional(),
	filterSample: zod.z.coerce.number().int().positive().optional(),
	filterTargets: zod.z.string().optional(),
	var: zod.z.record(zod.z.string(), zod.z.string()).optional(),
	generateSuggestions: zod.z.boolean().optional(),
	promptPrefix: zod.z.string().optional(),
	promptSuffix: zod.z.string().optional(),
	retryErrors: zod.z.boolean().optional(),
	envPath: zod.z.union([zod.z.string(), zod.z.array(zod.z.string())]).optional(),
	extension: zod.z.array(zod.z.string()).optional()
});
const GradingConfigSchema = zod.z.object({
	rubricPrompt: zod.z.union([
		zod.z.string(),
		zod.z.array(zod.z.string()),
		zod.z.array(zod.z.object({
			role: zod.z.string(),
			content: zod.z.string()
		}))
	]).optional(),
	provider: zod.z.union([
		zod.z.string(),
		zod.z.any(),
		zod.z.record(zod.z.string(), zod.z.union([zod.z.string(), zod.z.any()])).optional()
	]).optional(),
	factuality: zod.z.object({
		subset: zod.z.number().optional(),
		superset: zod.z.number().optional(),
		agree: zod.z.number().optional(),
		disagree: zod.z.number().optional(),
		differButFactual: zod.z.number().optional()
	}).optional()
});
const OutputConfigSchema = zod.z.object({
	postprocess: zod.z.string().optional(),
	transform: zod.z.string().optional(),
	transformVars: zod.z.string().optional(),
	storeOutputAs: zod.z.string().optional()
});
const EvaluateOptionsSchema = zod.z.object({
	cache: zod.z.boolean().optional(),
	delay: zod.z.number().optional(),
	eventSource: zod.z.string().optional(),
	generateSuggestions: zod.z.boolean().optional(),
	interactiveProviders: zod.z.boolean().optional(),
	maxConcurrency: zod.z.number().optional(),
	progressCallback: zod.z.custom((v) => typeof v === "function").optional(),
	repeat: zod.z.number().optional(),
	showProgressBar: zod.z.boolean().optional(),
	timeoutMs: zod.z.number().optional(),
	maxEvalTimeMs: zod.z.number().optional(),
	isRedteam: zod.z.boolean().optional(),
	silent: zod.z.boolean().optional()
});
const PromptMetricsSchema = zod.z.object({
	score: zod.z.number(),
	testPassCount: zod.z.number(),
	testFailCount: zod.z.number(),
	testErrorCount: zod.z.number(),
	assertPassCount: zod.z.number(),
	assertFailCount: zod.z.number(),
	totalLatencyMs: zod.z.number(),
	tokenUsage: BaseTokenUsageSchema,
	namedScores: zod.z.record(zod.z.string(), zod.z.number()),
	namedScoresCount: zod.z.record(zod.z.string(), zod.z.number()),
	redteam: zod.z.object({
		pluginPassCount: zod.z.record(zod.z.string(), zod.z.number()),
		pluginFailCount: zod.z.record(zod.z.string(), zod.z.number()),
		strategyPassCount: zod.z.record(zod.z.string(), zod.z.number()),
		strategyFailCount: zod.z.record(zod.z.string(), zod.z.number())
	}).optional(),
	cost: zod.z.number()
});
const CompletedPromptSchema = PromptSchema.extend({
	provider: zod.z.string(),
	metrics: PromptMetricsSchema.optional()
});
const ResultFailureReason = {
	NONE: 0,
	ASSERT: 1,
	ERROR: 2
};
const validResultFailureReasons = new Set(Object.values(ResultFailureReason));
function isResultFailureReason(value) {
	return validResultFailureReasons.has(value);
}
function isGradingResult(result) {
	return typeof result === "object" && result !== null && typeof result.pass === "boolean" && typeof result.score === "number" && typeof result.reason === "string" && (typeof result.namedScores === "undefined" || typeof result.namedScores === "object") && (typeof result.tokensUsed === "undefined" || typeof result.tokensUsed === "object") && (typeof result.componentResults === "undefined" || Array.isArray(result.componentResults)) && (typeof result.assertion === "undefined" || result.assertion === null || typeof result.assertion === "object") && (typeof result.comment === "undefined" || typeof result.comment === "string");
}
const BaseAssertionTypesSchema = zod.z.enum([
	"answer-relevance",
	"bleu",
	"classifier",
	"contains",
	"contains-all",
	"contains-any",
	"contains-html",
	"contains-json",
	"contains-sql",
	"contains-xml",
	"context-faithfulness",
	"context-recall",
	"context-relevance",
	"conversation-relevance",
	"cost",
	"equals",
	"factuality",
	"finish-reason",
	"g-eval",
	"gleu",
	"guardrails",
	"icontains",
	"icontains-all",
	"icontains-any",
	"is-html",
	"is-json",
	"is-refusal",
	"is-sql",
	"is-valid-function-call",
	"is-valid-openai-function-call",
	"is-valid-openai-tools-call",
	"is-xml",
	"javascript",
	"latency",
	"levenshtein",
	"llm-rubric",
	"pi",
	"meteor",
	"model-graded-closedqa",
	"model-graded-factuality",
	"moderation",
	"perplexity",
	"perplexity-score",
	"python",
	"regex",
	"rouge-n",
	"ruby",
	"similar",
	"similar:cosine",
	"similar:dot",
	"similar:euclidean",
	"starts-with",
	"tool-call-f1",
	"trace-error-spans",
	"trace-span-count",
	"trace-span-duration",
	"search-rubric",
	"webhook",
	"word-count"
]);
const SpecialAssertionTypesSchema = zod.z.enum([
	"select-best",
	"human",
	"max-score"
]);
const NotPrefixedAssertionTypesSchema = BaseAssertionTypesSchema.transform((baseType) => `not-${baseType}`);
const AssertionTypeSchema = zod.z.union([
	BaseAssertionTypesSchema,
	NotPrefixedAssertionTypesSchema,
	SpecialAssertionTypesSchema,
	zod.z.custom()
]);
const AssertionSetSchema = zod.z.object({
	type: zod.z.literal("assert-set"),
	assert: zod.z.array(zod.z.lazy(() => AssertionSchema)),
	weight: zod.z.number().optional(),
	metric: zod.z.string().optional(),
	threshold: zod.z.number().optional(),
	config: zod.z.record(zod.z.string(), zod.z.any()).optional()
});
const AssertionSchema = zod.z.object({
	type: AssertionTypeSchema,
	value: zod.z.custom().optional(),
	config: zod.z.record(zod.z.string(), zod.z.any()).optional(),
	threshold: zod.z.number().optional(),
	weight: zod.z.number().optional(),
	provider: zod.z.custom().optional(),
	rubricPrompt: zod.z.custom().optional(),
	metric: zod.z.string().optional(),
	transform: zod.z.string().optional(),
	contextTransform: zod.z.string().optional()
});
/**
* Schema for validating individual assertions (regular or assert-set).
* Used for runtime validation of user-provided config.
*/
const AssertionOrSetSchema = zod.z.union([AssertionSetSchema, AssertionSchema]);
const TestCasesWithMetadataPromptSchema = zod.z.object({
	prompt: CompletedPromptSchema,
	id: zod.z.string(),
	evalId: zod.z.string()
});
const ProviderPromptMapSchema = zod.z.record(zod.z.string(), zod.z.union([zod.z.string().transform((value) => [value]), zod.z.array(zod.z.string())]));
const MetadataSchema = zod.z.record(zod.z.string(), zod.z.any());
function isValidVarValue(value) {
	if (value === null || value === void 0) return false;
	const type = typeof value;
	if (type === "symbol" || type === "function") return false;
	return type === "string" || type === "number" || type === "boolean" || type === "object";
}
const VarsSchema = zod.z.custom((data) => {
	if (typeof data !== "object" || data === null || Array.isArray(data)) return false;
	if (Object.getPrototypeOf(data) !== Object.prototype && Object.getPrototypeOf(data) !== null) return false;
	return Object.values(data).every(isValidVarValue);
});
const TestCaseSchema = zod.z.object({
	description: zod.z.string().optional(),
	vars: VarsSchema.optional(),
	provider: zod.z.union([
		zod.z.string(),
		ProviderOptionsSchema,
		ApiProviderSchema
	]).optional(),
	providers: zod.z.array(zod.z.string()).optional(),
	prompts: zod.z.array(zod.z.string()).optional(),
	providerOutput: zod.z.union([zod.z.string(), zod.z.record(zod.z.string(), zod.z.unknown())]).optional(),
	assert: zod.z.array(zod.z.union([AssertionSetSchema, AssertionSchema])).optional(),
	assertScoringFunction: zod.z.union([zod.z.string().regex(new RegExp(`^file://.*\\.(${require_fileExtensions.JAVASCRIPT_EXTENSIONS?.join("|")}|py)(?::[\\w.]+)?$`)), zod.z.custom()]).optional(),
	options: zod.z.object({
		...PromptConfigSchema.shape,
		...OutputConfigSchema.shape,
		...GradingConfigSchema.shape,
		disableVarExpansion: zod.z.boolean().optional(),
		disableConversationVar: zod.z.boolean().optional(),
		runSerially: zod.z.boolean().optional()
	}).catchall(zod.z.any()).optional(),
	threshold: zod.z.number().optional(),
	metadata: zod.z.object({
		pluginConfig: zod.z.custom().optional(),
		strategyConfig: zod.z.custom().optional()
	}).catchall(zod.z.any()).optional()
});
const TestCaseWithVarsFileSchema = TestCaseSchema.extend({ vars: zod.z.union([
	VarsSchema,
	zod.z.string(),
	zod.z.array(zod.z.string())
]).optional() });
const TestCasesWithMetadataSchema = zod.z.object({
	id: zod.z.string(),
	testCases: zod.z.union([zod.z.string(), zod.z.array(zod.z.union([zod.z.string(), TestCaseSchema]))]),
	recentEvalDate: zod.z.date(),
	recentEvalId: zod.z.string(),
	count: zod.z.number(),
	prompts: zod.z.array(TestCasesWithMetadataPromptSchema)
});
const ScenarioSchema = zod.z.object({
	description: zod.z.string().optional(),
	config: zod.z.array(TestCaseSchema.partial()),
	tests: zod.z.array(TestCaseSchema)
});
const AtomicTestCaseSchema = TestCaseSchema.extend({ vars: VarsSchema.optional() }).strict();
/**
* Configuration schema for test generators that accept parameters
*
* @example
* ```yaml
* tests:
*   - path: file://test_cases.py:generate_tests
*     config:
*       dataset: truthfulqa
*       split: validation
*       max_rows: 100
* ```
*/
const TestGeneratorConfigSchema = zod.z.object({
	path: zod.z.string(),
	config: zod.z.record(zod.z.string(), zod.z.union([
		zod.z.string(),
		zod.z.number(),
		zod.z.boolean(),
		zod.z.array(zod.z.union([
			zod.z.string(),
			zod.z.number(),
			zod.z.boolean()
		])),
		zod.z.record(zod.z.string(), zod.z.any()),
		zod.z.any()
	])).optional()
});
const DerivedMetricSchema = zod.z.object({
	name: zod.z.string(),
	value: zod.z.union([zod.z.string(), zod.z.function({
		input: [zod.z.record(zod.z.string(), zod.z.number()), zod.z.custom()],
		output: zod.z.number()
	})])
});
const TestSuiteSchema = zod.z.object({
	tags: zod.z.record(zod.z.string(), zod.z.string()).optional(),
	description: zod.z.string().optional(),
	providers: zod.z.array(ApiProviderSchema),
	prompts: zod.z.array(PromptSchema),
	providerPromptMap: ProviderPromptMapSchema.optional(),
	tests: zod.z.array(TestCaseSchema).optional(),
	scenarios: zod.z.array(ScenarioSchema).optional(),
	defaultTest: zod.z.union([zod.z.string().refine((val) => val.startsWith("file://"), { error: "defaultTest string must start with file://" }), TestCaseSchema.omit({ description: true })]).optional(),
	nunjucksFilters: NunjucksFilterMapSchema.optional(),
	env: ProviderEnvOverridesSchema.optional(),
	derivedMetrics: zod.z.array(DerivedMetricSchema).optional(),
	extensions: zod.z.array(zod.z.string().refine((value) => value.startsWith("file://"), { error: "Extension must start with file://" }).refine((value) => {
		const parts = value.split(":");
		return parts.length === 3 && parts.every((part) => part.trim() !== "");
	}, { error: "Extension must be of the form file://path/to/file.py:function_name" }).refine((value) => {
		const parts = value.split(":");
		return (parts[1].endsWith(".py") || require_fileExtensions.isJavascriptFile(parts[1])) && (parts.length === 3 || parts.length === 2);
	}, { error: "Extension must be a python (.py) or javascript (.js, .ts, .mjs, .cjs, etc.) file followed by a colon and function name" })).nullable().optional(),
	redteam: zod.z.custom().optional(),
	tracing: zod.z.object({
		enabled: zod.z.boolean(),
		otlp: zod.z.object({
			http: zod.z.object({
				enabled: zod.z.boolean(),
				port: zod.z.number(),
				host: zod.z.string().optional(),
				acceptFormats: zod.z.array(zod.z.string())
			}).optional(),
			grpc: zod.z.object({
				enabled: zod.z.boolean(),
				port: zod.z.number()
			}).optional()
		}).optional(),
		storage: zod.z.object({
			type: zod.z.string(),
			retentionDays: zod.z.number()
		}).optional(),
		forwarding: zod.z.object({
			enabled: zod.z.boolean(),
			endpoint: zod.z.string(),
			headers: zod.z.record(zod.z.string(), zod.z.string()).optional()
		}).optional()
	}).optional()
});
const TestSuiteConfigSchema = zod.z.object({
	tags: zod.z.record(zod.z.string(), zod.z.string()).optional(),
	description: zod.z.string().optional(),
	providers: ProvidersSchema,
	prompts: zod.z.union([
		zod.z.string(),
		zod.z.array(zod.z.union([
			zod.z.string(),
			zod.z.object({
				id: zod.z.string(),
				label: zod.z.string().optional(),
				raw: zod.z.string().optional()
			}),
			PromptSchema
		])),
		zod.z.record(zod.z.string(), zod.z.string())
	]),
	tests: zod.z.union([
		zod.z.string(),
		zod.z.array(zod.z.union([
			zod.z.string(),
			TestCaseSchema,
			TestGeneratorConfigSchema
		])),
		TestGeneratorConfigSchema
	]).optional(),
	scenarios: zod.z.array(zod.z.union([zod.z.string(), ScenarioSchema])).optional(),
	defaultTest: zod.z.union([zod.z.string().refine((val) => val.startsWith("file://"), { error: "defaultTest string must start with file://" }), TestCaseSchema.omit({ description: true })]).optional(),
	outputPath: zod.z.union([zod.z.string(), zod.z.array(zod.z.string())]).optional(),
	sharing: zod.z.union([zod.z.boolean(), zod.z.object({
		apiBaseUrl: zod.z.string().optional(),
		appBaseUrl: zod.z.string().optional()
	})]).optional(),
	nunjucksFilters: zod.z.record(zod.z.string(), zod.z.string()).optional(),
	env: zod.z.union([ProviderEnvOverridesSchema, zod.z.record(zod.z.string(), zod.z.union([
		zod.z.string(),
		zod.z.number().transform((n) => String(n)),
		zod.z.boolean().transform((b) => String(b))
	]))]).optional(),
	derivedMetrics: zod.z.array(DerivedMetricSchema).optional(),
	extensions: zod.z.array(zod.z.string()).nullable().optional(),
	metadata: MetadataSchema.optional(),
	redteam: RedteamConfigSchema.optional(),
	writeLatestResults: zod.z.boolean().optional(),
	tracing: zod.z.object({
		enabled: zod.z.boolean().prefault(false),
		otlp: zod.z.object({
			http: zod.z.object({
				enabled: zod.z.boolean().prefault(true),
				port: zod.z.number().prefault(4318),
				host: zod.z.string().prefault("0.0.0.0"),
				acceptFormats: zod.z.array(zod.z.enum(["protobuf", "json"])).prefault(["json"])
			}).optional(),
			grpc: zod.z.object({
				enabled: zod.z.boolean().prefault(false),
				port: zod.z.number().prefault(4317)
			}).optional()
		}).optional(),
		storage: zod.z.object({
			type: zod.z.enum(["sqlite"]).prefault("sqlite"),
			retentionDays: zod.z.number().prefault(30)
		}).optional(),
		forwarding: zod.z.object({
			enabled: zod.z.boolean().prefault(false),
			endpoint: zod.z.string(),
			headers: zod.z.record(zod.z.string(), zod.z.string()).optional()
		}).optional()
	}).optional()
});
const UnifiedConfigSchema = TestSuiteConfigSchema.extend({
	evaluateOptions: EvaluateOptionsSchema.optional(),
	commandLineOptions: CommandLineOptionsSchema.partial().optional(),
	providers: ProvidersSchema.optional(),
	targets: ProvidersSchema.optional()
}).refine((data) => {
	const hasTargets = data.targets !== void 0;
	const hasProviders = data.providers !== void 0;
	return hasTargets && !hasProviders || !hasTargets && hasProviders;
}, { message: "Exactly one of 'targets' or 'providers' must be provided, but not both" }).transform((data) => {
	if (data.targets && !data.providers) {
		data.providers = data.targets;
		delete data.targets;
	}
	if (data.extensions === null || data.extensions === void 0 || Array.isArray(data.extensions) && data.extensions.length === 0) delete data.extensions;
	return data;
});
const OutputFileExtension = zod.z.enum([
	"csv",
	"html",
	"json",
	"jsonl",
	"txt",
	"xml",
	"yaml",
	"yml"
]);
const EvalResultsFilterMode = zod.z.enum([
	"all",
	"failures",
	"different",
	"highlights",
	"errors",
	"passes",
	"user-rated"
]);

//#endregion
Object.defineProperty(exports, 'AGENTIC_STRATEGIES', {
  enumerable: true,
  get: function () {
    return AGENTIC_STRATEGIES;
  }
});
Object.defineProperty(exports, 'ALIASED_PLUGIN_MAPPINGS', {
  enumerable: true,
  get: function () {
    return ALIASED_PLUGIN_MAPPINGS;
  }
});
Object.defineProperty(exports, 'AssertionOrSetSchema', {
  enumerable: true,
  get: function () {
    return AssertionOrSetSchema;
  }
});
Object.defineProperty(exports, 'AssertionSchema', {
  enumerable: true,
  get: function () {
    return AssertionSchema;
  }
});
Object.defineProperty(exports, 'AssertionSetSchema', {
  enumerable: true,
  get: function () {
    return AssertionSetSchema;
  }
});
Object.defineProperty(exports, 'AssertionTypeSchema', {
  enumerable: true,
  get: function () {
    return AssertionTypeSchema;
  }
});
Object.defineProperty(exports, 'AtomicTestCaseSchema', {
  enumerable: true,
  get: function () {
    return AtomicTestCaseSchema;
  }
});
Object.defineProperty(exports, 'BIAS_PLUGINS', {
  enumerable: true,
  get: function () {
    return BIAS_PLUGINS;
  }
});
Object.defineProperty(exports, 'BaseAssertionTypesSchema', {
  enumerable: true,
  get: function () {
    return BaseAssertionTypesSchema;
  }
});
Object.defineProperty(exports, 'BaseTokenUsageSchema', {
  enumerable: true,
  get: function () {
    return BaseTokenUsageSchema;
  }
});
Object.defineProperty(exports, 'CommandLineOptionsSchema', {
  enumerable: true,
  get: function () {
    return CommandLineOptionsSchema;
  }
});
Object.defineProperty(exports, 'CompletedPromptSchema', {
  enumerable: true,
  get: function () {
    return CompletedPromptSchema;
  }
});
Object.defineProperty(exports, 'CompletionTokenDetailsSchema', {
  enumerable: true,
  get: function () {
    return CompletionTokenDetailsSchema;
  }
});
Object.defineProperty(exports, 'ConversationMessageSchema', {
  enumerable: true,
  get: function () {
    return ConversationMessageSchema;
  }
});
Object.defineProperty(exports, 'DATASET_EXEMPT_PLUGINS', {
  enumerable: true,
  get: function () {
    return DATASET_EXEMPT_PLUGINS;
  }
});
Object.defineProperty(exports, 'DATASET_PLUGINS', {
  enumerable: true,
  get: function () {
    return DATASET_PLUGINS;
  }
});
Object.defineProperty(exports, 'DEFAULT_PLUGINS', {
  enumerable: true,
  get: function () {
    return DEFAULT_PLUGINS;
  }
});
Object.defineProperty(exports, 'DEFAULT_STRATEGIES', {
  enumerable: true,
  get: function () {
    return DEFAULT_STRATEGIES;
  }
});
Object.defineProperty(exports, 'DerivedMetricSchema', {
  enumerable: true,
  get: function () {
    return DerivedMetricSchema;
  }
});
Object.defineProperty(exports, 'EvalResultsFilterMode', {
  enumerable: true,
  get: function () {
    return EvalResultsFilterMode;
  }
});
Object.defineProperty(exports, 'EvaluateOptionsSchema', {
  enumerable: true,
  get: function () {
    return EvaluateOptionsSchema;
  }
});
Object.defineProperty(exports, 'FINANCIAL_PLUGINS', {
  enumerable: true,
  get: function () {
    return FINANCIAL_PLUGINS;
  }
});
Object.defineProperty(exports, 'FOUNDATION_PLUGINS', {
  enumerable: true,
  get: function () {
    return FOUNDATION_PLUGINS;
  }
});
Object.defineProperty(exports, 'GradingConfigSchema', {
  enumerable: true,
  get: function () {
    return GradingConfigSchema;
  }
});
Object.defineProperty(exports, 'HARM_PLUGINS', {
  enumerable: true,
  get: function () {
    return HARM_PLUGINS;
  }
});
Object.defineProperty(exports, 'INSURANCE_PLUGINS', {
  enumerable: true,
  get: function () {
    return INSURANCE_PLUGINS;
  }
});
Object.defineProperty(exports, 'InputsSchema', {
  enumerable: true,
  get: function () {
    return InputsSchema;
  }
});
Object.defineProperty(exports, 'LLAMA_GUARD_ENABLED_CATEGORIES', {
  enumerable: true,
  get: function () {
    return LLAMA_GUARD_ENABLED_CATEGORIES;
  }
});
Object.defineProperty(exports, 'LLAMA_GUARD_REPLICATE_PROVIDER', {
  enumerable: true,
  get: function () {
    return LLAMA_GUARD_REPLICATE_PROVIDER;
  }
});
Object.defineProperty(exports, 'MEDICAL_PLUGINS', {
  enumerable: true,
  get: function () {
    return MEDICAL_PLUGINS;
  }
});
Object.defineProperty(exports, 'MULTI_INPUT_EXCLUDED_PLUGINS', {
  enumerable: true,
  get: function () {
    return MULTI_INPUT_EXCLUDED_PLUGINS;
  }
});
Object.defineProperty(exports, 'MULTI_INPUT_VAR', {
  enumerable: true,
  get: function () {
    return MULTI_INPUT_VAR;
  }
});
Object.defineProperty(exports, 'MULTI_TURN_STRATEGIES', {
  enumerable: true,
  get: function () {
    return MULTI_TURN_STRATEGIES;
  }
});
Object.defineProperty(exports, 'NotPrefixedAssertionTypesSchema', {
  enumerable: true,
  get: function () {
    return NotPrefixedAssertionTypesSchema;
  }
});
Object.defineProperty(exports, 'OutputConfigSchema', {
  enumerable: true,
  get: function () {
    return OutputConfigSchema;
  }
});
Object.defineProperty(exports, 'OutputFileExtension', {
  enumerable: true,
  get: function () {
    return OutputFileExtension;
  }
});
Object.defineProperty(exports, 'PHARMACY_PLUGINS', {
  enumerable: true,
  get: function () {
    return PHARMACY_PLUGINS;
  }
});
Object.defineProperty(exports, 'PII_PLUGINS', {
  enumerable: true,
  get: function () {
    return PII_PLUGINS;
  }
});
Object.defineProperty(exports, 'PLUGIN_CATEGORIES', {
  enumerable: true,
  get: function () {
    return PLUGIN_CATEGORIES;
  }
});
Object.defineProperty(exports, 'PartialGenerationError', {
  enumerable: true,
  get: function () {
    return PartialGenerationError;
  }
});
Object.defineProperty(exports, 'PluginConfigSchema', {
  enumerable: true,
  get: function () {
    return PluginConfigSchema;
  }
});
Object.defineProperty(exports, 'PolicyObjectSchema', {
  enumerable: true,
  get: function () {
    return PolicyObjectSchema;
  }
});
Object.defineProperty(exports, 'PromptSchema', {
  enumerable: true,
  get: function () {
    return PromptSchema;
  }
});
Object.defineProperty(exports, 'ProviderOptionsSchema', {
  enumerable: true,
  get: function () {
    return ProviderOptionsSchema;
  }
});
Object.defineProperty(exports, 'ProvidersSchema', {
  enumerable: true,
  get: function () {
    return ProvidersSchema;
  }
});
Object.defineProperty(exports, 'REDTEAM_PROVIDER_HARM_PLUGINS', {
  enumerable: true,
  get: function () {
    return REDTEAM_PROVIDER_HARM_PLUGINS;
  }
});
Object.defineProperty(exports, 'REMOTE_ONLY_PLUGIN_IDS', {
  enumerable: true,
  get: function () {
    return REMOTE_ONLY_PLUGIN_IDS;
  }
});
Object.defineProperty(exports, 'RedteamConfigSchema', {
  enumerable: true,
  get: function () {
    return RedteamConfigSchema;
  }
});
Object.defineProperty(exports, 'ResultFailureReason', {
  enumerable: true,
  get: function () {
    return ResultFailureReason;
  }
});
Object.defineProperty(exports, 'STRATEGY_COLLECTIONS', {
  enumerable: true,
  get: function () {
    return STRATEGY_COLLECTIONS;
  }
});
Object.defineProperty(exports, 'STRATEGY_COLLECTION_MAPPINGS', {
  enumerable: true,
  get: function () {
    return STRATEGY_COLLECTION_MAPPINGS;
  }
});
Object.defineProperty(exports, 'STRATEGY_EXEMPT_PLUGINS', {
  enumerable: true,
  get: function () {
    return STRATEGY_EXEMPT_PLUGINS;
  }
});
Object.defineProperty(exports, 'ScenarioSchema', {
  enumerable: true,
  get: function () {
    return ScenarioSchema;
  }
});
Object.defineProperty(exports, 'Severity', {
  enumerable: true,
  get: function () {
    return Severity;
  }
});
Object.defineProperty(exports, 'SpecialAssertionTypesSchema', {
  enumerable: true,
  get: function () {
    return SpecialAssertionTypesSchema;
  }
});
Object.defineProperty(exports, 'StrategyConfigSchema', {
  enumerable: true,
  get: function () {
    return StrategyConfigSchema;
  }
});
Object.defineProperty(exports, 'TELECOM_PLUGINS', {
  enumerable: true,
  get: function () {
    return TELECOM_PLUGINS;
  }
});
Object.defineProperty(exports, 'TestCaseSchema', {
  enumerable: true,
  get: function () {
    return TestCaseSchema;
  }
});
Object.defineProperty(exports, 'TestCaseWithVarsFileSchema', {
  enumerable: true,
  get: function () {
    return TestCaseWithVarsFileSchema;
  }
});
Object.defineProperty(exports, 'TestCasesWithMetadataPromptSchema', {
  enumerable: true,
  get: function () {
    return TestCasesWithMetadataPromptSchema;
  }
});
Object.defineProperty(exports, 'TestCasesWithMetadataSchema', {
  enumerable: true,
  get: function () {
    return TestCasesWithMetadataSchema;
  }
});
Object.defineProperty(exports, 'TestGeneratorConfigSchema', {
  enumerable: true,
  get: function () {
    return TestGeneratorConfigSchema;
  }
});
Object.defineProperty(exports, 'TestSuiteConfigSchema', {
  enumerable: true,
  get: function () {
    return TestSuiteConfigSchema;
  }
});
Object.defineProperty(exports, 'TestSuiteSchema', {
  enumerable: true,
  get: function () {
    return TestSuiteSchema;
  }
});
Object.defineProperty(exports, 'UNALIGNED_PROVIDER_HARM_PLUGINS', {
  enumerable: true,
  get: function () {
    return UNALIGNED_PROVIDER_HARM_PLUGINS;
  }
});
Object.defineProperty(exports, 'UnifiedConfigSchema', {
  enumerable: true,
  get: function () {
    return UnifiedConfigSchema;
  }
});
Object.defineProperty(exports, 'VarsSchema', {
  enumerable: true,
  get: function () {
    return VarsSchema;
  }
});
Object.defineProperty(exports, 'categoryAliases', {
  enumerable: true,
  get: function () {
    return categoryAliases;
  }
});
Object.defineProperty(exports, 'getDefaultNFanout', {
  enumerable: true,
  get: function () {
    return getDefaultNFanout;
  }
});
Object.defineProperty(exports, 'isApiProvider', {
  enumerable: true,
  get: function () {
    return isApiProvider;
  }
});
Object.defineProperty(exports, 'isCustomStrategy', {
  enumerable: true,
  get: function () {
    return isCustomStrategy;
  }
});
Object.defineProperty(exports, 'isFanoutStrategy', {
  enumerable: true,
  get: function () {
    return isFanoutStrategy;
  }
});
Object.defineProperty(exports, 'isGradingResult', {
  enumerable: true,
  get: function () {
    return isGradingResult;
  }
});
Object.defineProperty(exports, 'isLanguageDisallowedStrategy', {
  enumerable: true,
  get: function () {
    return isLanguageDisallowedStrategy;
  }
});
Object.defineProperty(exports, 'isProviderOptions', {
  enumerable: true,
  get: function () {
    return isProviderOptions;
  }
});
Object.defineProperty(exports, 'isResultFailureReason', {
  enumerable: true,
  get: function () {
    return isResultFailureReason;
  }
});
Object.defineProperty(exports, 'isValidReusablePolicyId', {
  enumerable: true,
  get: function () {
    return isValidReusablePolicyId;
  }
});
Object.defineProperty(exports, 'pluginDescriptions', {
  enumerable: true,
  get: function () {
    return pluginDescriptions;
  }
});
Object.defineProperty(exports, 'riskCategorySeverityMap', {
  enumerable: true,
  get: function () {
    return riskCategorySeverityMap;
  }
});
//# sourceMappingURL=types-DY--pQrH.cjs.map